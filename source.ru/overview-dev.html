<!DOCTYPE HTML>
      
[%settitle Обзор FHIR  - разработчикам%]
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
[%file newheader%]

</head>
<style>
.code { counter-reset: listing }
code { counter-increment: listing; }
.code i:before { content: counter(listing) ". "; color: gray; }
.code i { float: left; clear: both; min-width: 2.5em; }
.code code:before { content: counter(listing) ". "; color: gray; display: inline-block; min-width: 2.5em; }
</style>
<body>
[%file newnavbar%]

<div class="col-9">


<h2>FHIR Overview - Developers</h2>

<p>
FHIR (Fast Health Interoperability Resources) предназначен для информационного обмена, который поддерживает предоставление медицинской помощи в самых разнообразных процессах. Спецификация базируется на и адаптирует стандартные отраслевые RESTful-методы для предоставления комплексной медицинской помощи в широком диапазоне команд.
</p>

<p>
Планируемая область применения FHIR обширна и покрывает человеческие и ветеринарные аспекты, медицинское обслуживание, публичную медицину, клинические исследования, административный и финансовый аспекты. Стандарт предназначен для глобального использования в широком разнообразии архитектур и сценариев.
<!-- The intended scope of FHIR is broad, covering human and veterinary,
clinical care, public health, clinical trials, administration and
financial aspects.  The standard is intended for global use in a wide
variety of architectures and scenarios. -->
</p>

<h3>Framework</h3>
<p>
В основе FHIR лежат "ресурсы" -  общие строительные блоки для любого обмена данными. Каждый ресурс имеет следующие <a href="resources.html">общие характеристики</a>:
</p>
<ul>
 <li>URL, который его идентифицирует</li>
 <li>Общие метаданные</li>
 <li><a href="narrative.html">Человекочитаемое резюме (summary) в формате XHTML</a></li>
 <li>Набор установленных общих элементов данных</li>
 <li><a href="extensibility.html">Система расширений (extensibility framework)</a> для поддержки изменений в здравоохранении</li>
</ul>
<p>
Ресурсы представляются либо в <a href="xml.html">XML</a>, либо в <a href="json.html">JSON</a>-формате. В спецификации FHIR определено <%resourcecount%> 
различных <a href="resourcelist.html">типов ресурсов</a>.
</p>

<h3>Example Patient</h3>
<p>
Это пример представления <a href="patient.html">пациента</a> в виде FHIR-объекта в формате JSON. Кодировка XML (XML encoding) также определена в спецификации.
</p>

<div class="example">
<pre class="json linecounter">
<code>{</code>
<code>  "resourceType": "Patient",</code>
<code>  "id" : "23434",</code>
<code>  "meta" : {</code>
<code>    "versionId" : "12",</code>
<code>    "lastUpdated" : "2014-08-18T01:43:30Z"</code>
<code>  }</code>
<code>  "text": {</code>
<code>    "status": "generated",</code>
<code>    "div": "&lt;!-- Snipped for Brevity -->"</code>
<code>  },</code>
<code>  "extension": [</code>
<code>    {</code>
<code>      "url": "http://example.org/consent#trials",</code>
<code>      "valueCode": "renal"</code>
<code>    }</code>
<code>  ],</code>
<code>  "identifier": [</code>
<code>    {</code>
<code>      "use": "usual",</code>
<code>      "label": "MRN",</code>
<code>      "system": "http://www.goodhealth.org/identifiers/mrn",</code>
<code>      "value": "123456"</code>
<code>    }</code>
<code>  ],</code>
<code>  "name": [</code>
<code>    {</code>
<code>      "family": [</code>
<code>        "Levin"</code>
<code>      ],</code>
<code>      "given": [</code>
<code>        "Henry"</code>
<code>      ],</code>
<code>      "suffix": [</code>
<code>        "The 7th"</code>
<code>      ]</code>
<code>    }</code>
<code>  ],</code>
<code>  "gender": {</code>
<code>    "text": "Male"</code>
<code>  },</code>
<code>  "birthDate": "1932-09-24",</code>
<code>  "active": true</code>
<code>}</code>
</pre>
</div>

<p>
Каждый ресурс состоит из:  
</p>
<ul>
  <li><b>resourceType</b> (строка 2) - Обязательный: FHIR определяет много различных типов ресурсов. См. <a href="resourcelist.html">полный индекс</a></li>
  <li><b>id</b> (строка 3) - Идентификатор ресурса. Всегда присутствует при обмене ресурсом, за исключением момента выполнения операции создания (ниже)</li>
  <li><b>meta</b> (строки 4 - 7) - Обычно присутствует: <a href="resources.html#meta">Common use/context data to all resources</a> и контролируется инфраструктурой. Отсутствует, если нет метаданных</li>
  <li><b>text</b> (строки 12 - 17) - Рекомендуется: XHTML, описывающий <a href="narrative.html">человекочитаемое представление</a> ресурса</li>
  <li><b>extension</b> (строки 12 - 17) - Необязательный: <a href="extensbility.html">Расширения</a> задаются с помощью системы расширений</li>
  <li><b>data</b> (строки 18 - 43) - Необязательный: элементы данных, определенные для каждого типа ресурса</li>
</ul>
<p>
Обратите внимание: хотя в данной спецификации JSON-свойства всегда идут в том порядке, в котором они были определены, большинство JSON-библиотек располагают свойства по другим критериям.
<!-- Note that though this specification always shows the JSON properties in the order they are defined, many JSON libraries order properties by other criteria. -->
</p>

<h3>Interactions</h3>
<p>
Для оперирования ресурсами FHIR  предоставляет <a href="http.html">REST API</a> с богатым, но простым набором взаимодействий:
</p>
<ul>
<li><a href="http.html#create">Create</a> = POST https://example.com/path/{resourceType}</li>
<li><a href="http.html#read">Read</a> = GET https://example.com/path/{resourceType}/{id}</li>
<li><a href="http.html#update">Update</a> = PUT https://example.com/path/{resourceType}/{id}</li>
<li><a href="http.html#delete">Delete</a> = DELETE https://example.com/path/{resourceType}/{id}</li>
<li><a href="http.html#search">Search</a> = GET https://example.com/path/{resourceType}?search parameters...</li>
<li><a href="http.html#history">History</a> = GET https://example.com/path/{resourceType}/{id}/_history</li>
<li><a href="http.html#transaction">Transaction</a> = POST https://example.com/path/</li>
<li><a href="operations.html">Operation</a> = GET https://example.com/path/{resourceType}/{id}/${opname}</li>
</ul>
<p>
FHIR-спецификация описывает и другие виды обмена, лежащими за пределами этого простого  RESTful API, 
включая обмен группами ресурсов в виде <a href="documents.html">документов (Documents)</a>, 
<a href="messaging.html">сообщений (Messages)</a> и с использованием других видов <a href="services.html">сервисов</a>. 
</p>

<h3>Managing Variability</h3>
<p>
Одной из особенностей медицинской отрасли является существование большой разницы между различными юрисдикциями и секциями промышленности, и отсутствие центральной власти для навязывания общих бизнес-практик. Поэтому спецификация FHIR вводит <a href="extensibility.html">общую систему расширений</a> и выделяет <a href="profiling.html">фреймворк для управления этой вариабельностью</a>.
</p>

<h3>Создание ресурса</h3>
<p>
Для <a href="http.html#create">создания ресурса</a>отправьте HTTP POST-запрос в соответствующей точке взаимодействия ресурса. В примере ниже мы видим создание ресурса "пациент".
</p>

<div class="example">
<pre class="http linecounter">
<code>POST {some base path}/Patient HTTP/1.1</code>
<code>Authorization: Bearer 37CC0B0E-C15B-4578-9AC1-D83DCED2B2F9</code>
<code>Accept: application/json+fhir</code>
<code>Content-Type: application/json+fhir</code>
<code>Content-Length: 1198</code>
<code> </code>
<code>{</code>
<code>  "resourceType": "Patient",</code>
<code>  ...</code>
<code>}</code>
</pre>
</div>

<p>
Submit a new patient to the server, and ask it to store the patient with an id of its own choice. Notes:
</p>
<ul>
  <li><b>/Patient</b> (строка 1) - управление всеми пациентами - используйте имя типа ресурса</li>
  <li><b>Authorization</b> (строка 2) - см. <a href="security.html">Security for FHIR</a></li>
  <li><b>Accept, Content-Type</b> (строки 3-4) - тип содержимого для всех FHIR-ресурсов, который описан в JSON (либо application/xml+fhir для XML-версии). FHIR-ресурсы всегда используют кодировку UTF-8</li>
  <li><b>id</b> (строка 9) - У ресурса, который создается, еще пока нет идентификатора - его ему назначит сервер</li>
  <li>Resource Content, строки 8+ - На этом этапе свойство meta отсутствует. Остальное содержимое ресурса совпадает с указанным выше</li>
</ul>


<h3>Create Response</h3>
<p>
Ответ содержит HTTP-код 201, указывающий, что ресурс был создан успешно. Заголовок location указывает, где ресурс может быть получен в последующих запросах. Сервер может вернуть ресурс <a href="operationoutcome.html">OperationOutcome</a>, но не обязан этого делать.
</p>

<div class="example">
<pre class="http linecounter">
<code>HTTP/1.1 201 Created</code>
<code>Content-Length: 161</code>
<code>Content-Type: application/json+fhir</code>
<code>Date: Mon, 18 Aug 2014 01:43:30 GMT</code>
<code>ETag: 1</code>
<code>Location: http://example.com/Patient/347</code>
<code> </code>
<code>{</code>
<code>  &quot;resourceType&quot;: &quot;OperationOutcome&quot;,</code>
<code>  &quot;text&quot;: {</code>
<code>    &quot;status&quot;: &quot;generated&quot;,</code>
<code>    &quot;div&quot;: &quot;&lt;div xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;The operation was succesful&lt;/div&gt;&quot;</code>
<code>  }</code>
<code>}</code>
</pre>
</div>

<p>
Примечания:
</p>
<ul>
  <li><b>HTTP/1.1 201</b> (строка 1) - the operation was successful. Note that HTTP/1.1 is strongly recommended but not required</li>
  <li><b>ETag</b> (строка 5) - used in the <a href="http.html#update">version aware update</a> pattern</li>
  <li><b>Location</b> (строка 6) - the id the server assigned to the resource. The id in the url must match the id in the resource when it is subsequently returned</li>
  <li><b>operationOutcome</b> (строка 9) - OperationOutcome resources in this context have no id or meta element (they have no managed identity)</li>
</ul>

<h4>Error response</h4>

<p>
For a variety of reasons, servers may need to return an error. Clients should be alert to 
authentication related responses, but FHIR content related errors should be returned using an 
appropriate HTTP status code, with an <a href="operationoutcome.html">OperationOutcome</a> resource to provide additional information.
Here is an example of a server rejecting a resource because of server defined business rules:
</p>

<div class="example">
<pre class="http linecounter">
<code>HTTP/1.1 422 Unprocessable Entity</code>
<code>Content-Length: 161</code>
<code>Content-Type: application/json+fhir</code>
<code>Date: Mon, 18 Aug 2014 01:43:30 GMT</code>
<code> </code>
<code>{</code>
<code>  &quot;resourceType&quot;: &quot;OperationOutcome&quot;,</code>
<code>  &quot;text&quot;: {</code>
<code>    &quot;status&quot;: &quot;generated&quot;,</code>
<code>    &quot;div&quot;: &quot;&lt;div xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;MRN conflict</code>
<code>   - the MRN 123456 is already assigned to a different patient&lt;/div&gt;&quot;</code>
<code>  },</code>
<code>}</code>
</pre>
</div>

<p>
Notes:
</p>
<ul>
  <li>The server can return additional structured information using the details of the <a href="operationoutcome.html">OperationOutcome</a></li>
</ul>


<h3>Read Request</h3>
<p>
<a href="http.html#read">Reading a resource</a> is done by sending HTTP GET requests to the desired Resource
end point, as in this example. 
</p>
<div class="example">
<pre class="http linecounter">
<code>GET /Patient/347?_format=xml HTTP/1.1</code>
<code>Host: example.com</code>
<code>Accept: application/xml+fhir</code>
<code>Cache-Control: no-cache</code>
</pre>
</div>

<p>
Notes:
</p>
<ul>
  <li><b>347</b> (line 1) - The id of the resource that is being fetched</li>
  <li><b>_format=xml</b> (line 1) - this is another method for clients to indicate the desired response format, in addition to using the accept header, and is useful for clients that don't have access to the HTTP Headers (e.g. XSLT transforms) (se <a href="http.html#mimetypes">Mime Types</a></li>
  <li><b>cache control</b> (line 4) - Concurrency control is important, though FHIR itself says nothing about it - see <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html">http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html</a> or <a href="https://www.mnot.net/cache_docs/">https://www.mnot.net/cache_docs/</a></li>
</ul>


<h3>Read Response</h3>
<p>
The response to a GET contains the Resource. 
</p>

<div class="example">
<pre class="http linecounter">
<code>HTTP/1.1 200 OK</code>
<code>Content-Length: 729</code>
<code>Content-Type: application/xml+fhir</code>
<code>Last-Modified: Sun, 17 Aug 2014 15:43:30 GMT</code>
<code>ETag: 1</code>
<code> </code>
<code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</code>
<code>&lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;</code>
<code>  &lt;id value=&quot;347&quot;/&gt;</code>
<code>  &lt;meta&gt;</code>
<code>    &lt;versionId value=&quot;1&quot;/&gt;</code>
<code>    &lt;lastUpdated value=&quot;2014-08-18T01:43:30Z&quot;/&gt;</code>
<code>  &lt;/meta&gt;</code>
<code>  &lt;!-- content as shown above for patient --&gt;  </code>
<code>&lt;/Patient&gt;</code>
</pre>
</div>

<p>
Notes:
</p>
<ul>
  <li><b>id</b> (line 8) - The id of the resource. This must match the id in the read request</li>
  <li><b>versionId</b> (line 11) - The current version id of the resource. Best practice is that this value matches the ETag (see <a href="http.html#update">version aware update</a>), but clients must never assume this. Note that some servers do not track the version of the resource</li>
  <li>Note that servers are not required to support versioning, but are strongly encouraged to do so</li>
  <li><b>lastUpdated</b> (line 12) - if present, this must match the value in the HTTP header</li>
</ul>

<h3>Search Request</h3>
<p>
In addition to getting single known resources it is possible to find resources by 
<a href="http.html#search">searching the resource end point</a> with a <a href="search.html">set of 
criteria</a> describing the set of resources that should be retrieved and their order. The
general pattern is:
</p>
<div class="example">
<pre class="http">
GET base/{resourceType}?criteria HTTP/1.1
</pre>
</div>
<p>
or simply https://example.com/{resourceType}?criteria. The criteria is a set of 
http parameters that specify which resources to return. The search operation
</p>

<div class="example">
<pre class="http">
https://example.com/base/MedicationPrescription?patient=347
</pre>
</div>
<p>
returns all the prescriptions for the patient created above.
</p>

<h3>Search Response</h3>
<p>
The response to a search request is a <a href="extras.html#bundle">bundle</a>: list of matching resources with some metadata:
</p>

<div class="example">
<pre class="json linecounter">
<code>{</code>
<code>  "resourceType": "Bundle",</code>
<code>  "id" : "eceb4882-5c7e-4ca4-af62-995dfb8cef01"</code>
<code>  "meta" : {</code>
<code>    "lastUpdated" : "2014-08-19T15:43:30Z"</code>
<code>  },</code>
<code>  "base": "http://example.com/base",</code>
<code>  "total": "3",</code>
<code>  "link": [</code>
<code>    {</code>
<code>      "relation" : "next",</code>
<code>      "url" : "https://example.com/base/MedicationPrescription?patient=347&amp;searchId=ff15fd40-ff71-4b48-b366-09c706bed9d0&amp;page=2"</code>
<code>    }, {</code>
<code>      "relation" : "self",</code>
<code>      "url" : "https://example.com/base/MedicationPrescription?patient=347"</code>
<code>    }</code>
<code>  ],</code>
<code>  "item": [</code>
<code>    {</code>
<code>      "resourceType": "MedicationPrescription",</code>
<code>      "id" : "3123",</code>
<code>      "meta" : {</code>
<code>        "versionId" : "1",</code>
<code>        "lastUpdated" : "2014-08-16T05:31:17Z"</code>
<code>      }, </code>
<code>      ... content of resource ...</code>
<code>    }, </code>
<code>    ... 2 additional resources ....</code>
<code>  ]</code>
<code>}</code>
</pre>
</div>

<p>
Notes:
</p>
<ul>
  <li><b>resourceType</b> (line 7) - "SearchResults" is the name for a bundle returned from a search</li>
  <li><b>id</b> (line 3) - An identifier assigned to this particular bundle. The server should assign a unique id to this bundle that it will not be re-used. Note that in some bundles - though not search results - this must be <a href="extras.html#bundle-unique">globally unique</a></li>
  <li><b>meta.lastUpdated</b> (line 10) - This should match the HTTP header, and should be the date the search was executed, or more recent, depending on how the <a href="search.html#currency">server handles ongoing updates</a>. The lastUpdated data SHALL be the same or more recent than the most recent resource in the results</li>
  <li><b>base</b> (line 12) - The base URL for any relative <a href="references.html">references</a> in the resources. The server SHOULD provide this value</li>
  <li><b>total</b> (line 13) - The total number of matches in the search results. Not the number of matches in this particular bundle, which may be a <a href="http.html#search">paged view into the results</a></li>
  <li><b>link</b> (line 14) - A set of named links that give related contexts to this bundle. Names defined in this specification: <a href="http.html#search">first</a>, <a href="http.html#search">prev</a>, <a href="http.html#search">next</a>, <a href="http.html#search">last</a>, <a href="http.html#search">self</a></li>
  <li><b>item</b> (line 23) - The actual resources in this set of results</li>
  <li>In addition, the search operation is also able to <a href="search.html#include">return additional related resources</a> as well</li>
</ul>

<h3>Update Request</h3>
<p>
The client sends the server a new version of the resource to replace the exist version.
</p>

<div class="example">
<pre class="http linecounter">
<code>PUT /Patient/347 HTTP/1.1</code>
<code>Host: example.com</code>
<code>Content-Type: application/json+fhir</code>
<code>Content-Length: 1435</code>
<code>Accept: application/json+fhir</code>
<code>If-Match: 1</code>
<code> </code>
<code>{</code>
<code>  "resourceType": "Patient",</code>
<code>  "id" : "347",</code>
<code>  "meta" : {</code>
<code>    "versionId" : "1",</code>
<code>    "lastUpdated" : "2014-08-18T01:43:30Z"    </code>
<code>  },</code>
<code>  ...</code>
<code>}</code>
</pre>
</div>

 <p>
Notes:
</p>
<ul>
  <li><b>resourceType</b> (line 1) - "Patient" in the url must match the resource type in the resource (line 9)</li>
  <li><b>resource id</b> (line 1, "347") - This must match the id in the resource (line 9)</li>
  <li><b>If-Match</b> (line 6) - if this is provided, it must match the value in meta.versionId (line 12), and the server must check the version integrity, or return 412 if it doesn't support versions</li>
  <li><b>meta.lastUpdated</b> (line 10) - This value is ignored, and will be updated by the server</li>
  <li><b>resource content</b> (line 14) - Not shown here, the same as Patient above</li>
</ul>

<h3>Update Response</h3>
<p>
The response to an update request has metadata / status, and optionally an OperationOutcome:
</p>

<div class="example">
<pre class="http linecounter">
<code>HTTP/1.1 200 OK</code>
<code>Content-Length: 161</code>
<code>Content-Type: application/json+fhir</code>
<code>Date: Mon, 18 Aug 2014 01:43:30 GMT</code>
<code>ETag: 2</code>
<code> </code>
<code>{</code>
<code>  &quot;resourceType&quot;: &quot;OperationOutcome&quot;,</code>
<code>  &quot;text&quot;: {</code>
<code>    &quot;status&quot;: &quot;generated&quot;,</code>
<code>    &quot;div&quot;: &quot;&lt;div xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;The operation was succesful&lt;/div&gt;&quot;</code>
<code>  }</code>
<code>}</code>
</pre>
</div>


<p>
Notes:
</p>
<ul>
  <li><b>ETag</b> (line 5) - This is the versionId of the new version</li>
</ul>

<h3>Base Resource Content</h3>
<p>
Here is an exmple that shows all the information found in all resources, fully populated:
</p>

<div class="example">
<pre class="json linecounter">
<code>{</code>
<code>  "resourceType" : "X",</code>
<code>  "id" : "12",</code>
<code>  "meta" : {</code>
<code>    "versionId" : "12",</code>
<code>    "lastUpdated" : "2014-08-18T01:43:30Z",</code>
<code>    "profile" : ["http://example-consortium.org/fhir/profile/patient"],</code>
<code>    "security" : [{</code>
<code>      "system" : "http://hl7.org/fhir/v3/ActCode",</code>
<code>      "code" : "EMP"</code>
<code>    }],</code>
<code>    "tag" : [{</code>
<code>      "system" : "http://example.com/codes/workflow",</code>
<code>      "code" : "needs-review"</code>
<code>    }]</code>
<code>  },</code>
<code>  "implicitRules" : "http://example-consortium.org/fhir/ehr-plugins",</code>
<code>  "language" : "X"</code>
<code>}</code>
</pre>
</div>

<p>
Implementers notes:  
</p>
<ul>
  <li><b>resourceType</b> (line 2) - always found in every resource. In XML, this is the name of the root element for the resource</li>
  <li><b>id</b> (line 3) - defined when the resource is created, and never changed. Only missing when the resource is first created</li>
  <li><b>meta.versionId</b> (line 5) - changes each time any resource contents change (except for the last 3 elements in meta)</li>
  <li><b>meta.lastUpdated</b> (line 6) - Changes when the versionId changes. Systems that don't support versions usually don't track lastUpdated either</li>
  <li><b>meta.profile</b> (line 7) - An assertion that the content conforms to a profile. See <a href="profiling.html#resources">Extending and Restricting Resources</a> for further discussion. Can be changed as profiles and value sets change or the system rechecks conformance</li>
  <li><b>meta.security</b> (lines 8 - 11) - <a href="securitylabels.html">Security labels</a> applied to this resource. These tags connect resources in specific ways to the overall security policy and infrastructure. Security tags can be updated when the resource changes, or whenever the security sub-system chooses to</li>
  <li><b>meta.tag</b> (lines 12 - 15) - <a href="extras.html">Tags</a> applied to this resource. Tags are used to relate resources to process and workflow. Applications are not required to consider the tags when interpreting the meaning of a resource. Tags can be <a href="http.html#tags">updated</a> without changing the resource version</li>
  <li><b>implicitRules</b> (lines 16) - indicates that there is a <a href="profiling.html#agreement">custom agreement</a> about how the resources are used that must be understood in orer to safely process the resource. Use of this is discouraged because it restricts sharing, but sometimes necessary</li>
  <li><b>language</b> (lines 17) - The <a href="narrative.html#language">base language of the resource</a>. The resource is allowed to have content from other languages; this is just the base, but should be the main language of the resource</li>
</ul>

</div>

[%file newfooter%]
    
    
</body>
</html>

