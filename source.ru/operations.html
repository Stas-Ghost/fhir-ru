<!DOCTYPE HTML>


[%settitle Расширенные операции RESTful API%]
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
[%file newheader%]
</head>
<body>
[%file newnavbar%]

<div class="col-9">

<a name="base"> </a>
<h2>Расширенные операции RESTful API</h2>

<p>
<a href="http.html">RESTful API</a> задает набор простых взаимодействий, совершаемых над репозиторием типизированных ресурсов (read, update, search и проч.). Эти взаимодействия следуют парадигме RESTful об управлении состоянием с помощью действий Create/Read/Update/Delete над набором идентифицированных ресурсов. Хотя этот подход покрывает большинство случаев использования, имеется некоторая специфичная функциональность, которую можно ююю более эффективно с помощью RPC-подобной парадигмы, где именованные операции выполняются над входными и выходными данными. Данная спецификация описывает простую структуру операций, которая легко расширяет RESTful API.
</p>
<p>
Операции обладают следующими общими свойствами:
</p>
<ul>
 <li>У каждой операции имеется имя</li>
 <li>У каждой операции имеется перечень входных и выходных параметров</li>
 <li>Этими параметрами являются либо ресурсы, либо типы данных, либо параметры поиска</li>
 <li>Операции подлежат тем же мерам безопасности, что и RESTful API</li>
 <li>URI точек взаимодействия операций основываются на существующей схеме адресов RESTful API</li>
 <li>Операции могут воспользоваться существующим репозиторием ресурсов в своих определениях</li>
</ul>

<p>
Примечание: определение этих сервисов не исключает использование других видов сервисов, не зависящих от или интегрированных с RESTful API.
</p>

<a name="defined"> </a>
<h3>Операции, определенные FHIR</h3>
<p>
Данная спецификация дает определение нескольких операций:
</p>
<%operationslist%>
<p>
Реализации имеют возможность определять свои собственные операции в дополнение к тем, что заданы здесь. Конфликт имен между операциями, определенными различными исполнителями, может решаться использованием 
<a href="conformance.html">заявления о соответствии</a>.
</p>

<a name="defining"> </a>
<h3>Определение операции</h3>

<p>
Любая операция задается следующими данными:
</p>
<ul>
 <li>Контекст операции - система, тип ресурса или экземпляр ресурса</li>
 <li>Имя операции</li>
 <li>Перечень параметров с их определениями</li>
</ul>

<p>
Для каждого параметра необходима следующая информация:
</p>
<ul>
 <li>Имя - имя операции. Для удобства разработчиков, имя должно быть допустимым токеном (см. ниже)</li>
 <li>Использование - In | Out | Both</li>
 <li>Тип - тип данных, тип параметра поиска, тип ресурса или "Document". Выходные параметры должны иметь тип ресурса</li>
 <li>Документация - описание его использования</li>
</ul>

<p>
Отметьте, что типы параметров поиска разрешается использовать, если параметр используется в качестве параметра поиска, т. е. чтобы связать между собой контекст операций и набор существующих ресурсов, на которые направлена операция, где для предоставления информации непосредственно операции в равной степени используются типы данных и ресурсы. Определение параметра должно делать его использование понятным.
</p>

<a name="executing"> </a>

<h3>Исполнение операции</h3>

<p>
URL точки взаимодействия операции зависит от ее контекста:
</p>
<ul>
 <li>система: URL - [base]/$[name]</li>
 <li>тип ресурса: URL - [base]/[type]/$[name]</li>
 <li>экземпляр ресурса: URL - [base]/[type]/[id]/$[name]</li>
</ul>

<a name="request"> </a>
<h4>Запрос на операцию</h4>

<p>
В общем случае операция вызывается выполнением HTTP POST-запроса к точке взаимодействия операции. Содержимым тела [запроса] является <a href="http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.2">multipart/form-data</a>, которые содержат параметры операции. Там, где типом параметра является тип данных или ресурсы, содержимое может быть представлено либо в JSON, либо в XML; для типа данных корневым именем объекта является имя параметра.
</p>
<p>
Некоторые пояснения к этому формату:
</p>
<ul>
 <li>Для ресурсов и типов данных ДОЛЖЕН быть указан заголовок Content-Type, однако он может не указываться, если содержимое передается в HTML-форме</li>
 <li>В качестве примера операции см. <a href="op-example-request.html">пример запроса на расширение набора значений</a></li>
</ul>

<p>
Если имеется только один комплексный параметр (например параметр, где представлением является XML или JSON, а не параметр поиска), тогда операция может быть совершена HTTP POST-запросом с комплексным параметром в качестве тела сообщения и другими параметрами, добавленными к URL в поисковой части URL (например после символа "?").
</p>
<p>
Если у операции нет комплексных параметров, операция может быть вызвана выполнением операции HTTP GET, где все параметры добавляются к URL в поисковой части URL (например после символа "?").
</p>


<a name="response"> </a>

<h4>Ответ на операцию</h4>

<p>
Если операция выполняется успешно, HTTP-статус возвращает код 200 ОК. Код HTTP-статуса вида 4xx или 5xx говорит об ошибке. Пользовательским агентам следует отметить, что серверы могут переадресовывать клиента для аутентификации в ответ на запрос операции.
</p>

<p>
Результатом операции является <a href="extras.html#bundle">комплект</a> , содержащий ноль или больше ресурсов. Обратите внимание, что  в отношении <a href="http.html#mime-type">content types</a> применяется то же самое соглашение, что и к RESTful-интерфейсу. 
</p>
<p>
Идентификация параметров по имени....

</p>
<p>
Ресурсы, возвращаемые в результате операции, могут быть сохранены и доступны в репозитории ресурсов на 
сервере операции. В этом случае сервер будет обеспечивать идентичность ресурса в идентификаторах записи комплекта. Когда ресурсы, которые не сохраняются, возвращаются в Atom-фиде, им должен быть присвоен идентификатор cid, который не используется повторно.
</p>

</div>

[%file newfooter%]
</body>
</html>
