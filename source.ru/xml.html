<!DOCTYPE HTML>


<!--
These elements SHALL always appear in this order. These basic elements shared by all resources come first
in order to support consistent definitions for schema and UML derived code. 
-->
      
[%settitle Формат XML%]
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
[%file newheader%]
</head>
<body>
[%file newnavbar%]

<div class="col-9">

<%fmtheader xml%>

<a name="root"> </a>
<h2>XML-представление ресурсов</h2>

<p>
XML-представление для ресурса описано с помощью следующего формата: 
</p>
<pre class="spec">
 &lt;<b>name</b> xmlns="http://hl7.org/fhir" (attrA="value")&gt;   <span style="float: right"><a title="Documentation for this format" href="xml.html"><img src="help.png" alt="doco"/></a></span>
   &lt;<u><b title="Formal Definition (must be supported or understood)">nameA</b></u>&gt;<font color="Gray">&lt;!-- </font><span title="Inv-5: Some rule apples to this element" style="color: brown"><b><img alt="??" src="lock.png"/> 1..1</b></span> <font color="Darkgreen">type</font> <font color="Navy">description of content</font> <font color="Gray"> --&gt;</font>&lt;nameA&gt;
   &lt;<b title="Formal Definition">nameB[x]</b>&gt;<font color="Gray">&lt;!-- </font><font color="brown">0..1</font> <font color="darkgreen">type1</font>|<font color="darkgreen">type1</font> <font color="Navy">description</font> <font color="Gray"> --&gt;</font>&lt;/nameB&gt;
   &lt;<b>nameC</b>&gt; <font color="Brown"><font color="Gray">&lt;!-- </font> <b>1..*</b> --&gt;</font>
     &lt;<b>nameD</b>&gt;<font color="Gray">&lt;!-- </font><font color="brown">1..1</font> <font color="darkgreen">type</font>&gt;<font color="navy">Relevant elements</font> <font color="Gray"> --&gt;</font>&lt;/nameD&gt;
   &lt;/nameC&gt;
 &lt;name&gt;
</pre>
<p>
Этот формат используется для:
</p>
<ul>
 <li>Для создания допустимого XML-экземпляра ресурса просто замените содержимое элементов и атрибутов допустимыми значениями в соответствии с кардинальным множеством, типовыми правилами и комментариями к каждому элементу</li>
 <li>Имена ресурсов и элементов являются регистрозависимыми (тем не менее дубликаты, различающиеся только регистром, никогда не вводились)</li>
 <li>Элементы должны всегда появляться в том порядке, в котором они описаны</li>
 <li>Когда повторение элемента разрешено, элементы упорядочены, и реализации должны сохранять этот порядок (примечание: смысл такого упорядочения может быть не известен)
 <!-- When an element is allowed to repeat, the elements are ordered, and implementations must preserve order (note: the meaning of the order may not be known) --></li>
 <li>Некоторые свойства представлены в виде атрибутов: примитивные значения в атрибуте "value", URL-адреса расширений в атрибуте "url" в расширениях, и свойство "id"</li>
 <li>Любой из XML-элементов может иметь атрибут "id", служащий в качестве <a href="references.html#id">цели внутренней ссылки</a>. Атрибут "id" не показывается в этом формате</li>
 <li>FHIR-элементы всегда принадлежат пространству имен <a href="http://hl7.org/fhir">http://hl7.org/fhir</a>. Обычно оно указывается в корневом элементе в качестве пространства имен по умолчанию.
В FHIR-ресурсах может встретиться ещё только одно пространство имен - XHTML (<a href="narrative.html">XHTML встречается в большинстве ресурсов)</a></li>
 <li>Инфраструктурные элементы, являющиеся общими для всех ресурсов, не приводятся в этом xml-представлении. Они должны появляться до любых других заданных элементов-потомков в следующем порядке:
	<ul>
		<li>Сначала элементы из <a href="resource.html">базового ресурса (base)</a> в заданном порядке</li>
		<li>Потом элементы из <a href="domainresource.html">ресурса domain </a> в заданном порядке</li>
	</ul>
 </li>
 <li>FHIR-элементы не бывают пустыми. Если элемент присутствует в ресурсе, он ОБЯЗАН иметь либо атрибут value, либо элементы-потомки, определенные для его типа, либо 1 или больше <a href="extensibility.html">расширений</a></li>
 <li>Атрибуты не могут быть пустыми. Либо они отсутствуют, либо присутствуют с по крайней мере одним символом не пробельного содержимого</li>
 <li>Иконка замочка (<img alt="??" src="lock.png"/>) означает, что элемент вводит или зависит от  <a href="conformance-rules.html#invariants">дополнительных правил</a>, которые регулируют его пристутсвие и/или содержимое</li>
 <li>XML-комментарии, команды обработки и форматирования не являются частью содержимого ресурса</li>
 <li>XML-ресурсы должны обмениваться в кодировке UTF-8. Указание схемы кодирования символов с помощью команды обработки &lt;?xml encoding="UTF-8" ?&gt; не обязательно, но рекомендуется</li>
 <li>Другие команды обработки НЕ ДОЛЖНЫ быть включены и НЕ ДОЛЖНЫ требоваться в целях правильного понимания и/или представления данных ресурса или его описательной части. 
Приложения МОГУТ сохранять команды обработки при оперировании ресурсами, но это не является обязательным</li>
 <li>MIME-тип для этого формата - application/xml+fhir</li>
</ul>

<a name="schema"> </a>
<h3>XML Schema и Schematron</h3>
<p>
Спецификация предоставляет XML-схемы для всех моделей содержимого, которые она описывает.
</p>
<p>
Базовая XML-схема называется "<a href="fhir-base.xsd">fhir-base.xsd</a>" и определеяет все типы данных и базовые инфраструктурные типы. Кроме того, имеется схема для каждого ресурса и общая схема <a href="fhir-all.xsd">fhir-all.xsd</a>, которая включает в себя схемы всех ресурсов. Для процессоров схемы, которые не поддерживают циклические включения, имеется <a href="fhir-single.xsd">единая схема</a>, которая содержит всё.
</p>
<p>
В дополнение к файлам w3c-схемы, данная спецификация также приводит Schematron-файлы, которые вводят в действие различные ограничения, определенные для типов данных и ресурсов. Они укомплектованы в файлы для каждого ресурса.
</p>
<p>
Обмениваемый XML ДОЛЖЕН быть проверен на соответствие w3c-схеме и Schematron, хотя соответствие схеме и Schematron не является достаточным условием, чтобы являться совместимым экземпляром: данная спецификация вводит несколько правил, которые не могут быть проверены никакими механизмами.
Операционные системы могут использовать инструменты схемы для проверки валидации, но не обязаны это делать.
Обмениваемое содержимое НЕ ДОЛЖНО задавать схему или даже просто содержать пространство имен экземпляра схемы в самом ресурсе. 
</p>

<h3>Цифровые подписи</h3>
<a name="digsig"> </a>
<p>Ресурсы и/или комплекты (Bundles) могут быть подписаны цифровой подписью (ссылка будет предоставлена). Одним из последствий подписания документа является то, что URL-адреса, идентификаторы и внутренние ссылки замораживаются и не могут быть изменены. Это может быть желаемым свойством, но может также лишить способности к взаимодействию закрытые экосистемы, где часто происходит <a href="managing.html">повторное определение (re-identification)</a>. По этой причине рекомендуется подписывать только Комплекты документов (Document Bundles) и только после того, как все связанные ресурсы находятся в комплекте.</p>

<p>
todo: canonical XML
</p>



<!-- Todo: Relax NG, RDF, eCore -->


</div>

[%file newfooter%]
</body>
</html>