<!DOCTYPE HTML>


      
[%settitle Формат XML%]
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
[%file newheader%]
</head>
<body>
[%file newnavbar%]

<div class="col-9">


<a name="root"> </a>
<h2>XML</h2>

<p>
XML-синтаксис основан непосредственно на <a href="formats.html">XML-нотации</a>:
</p>
<pre class="spec">
 &lt;<b>name</b> xmlns="http://hl7.org/fhir" (attrA="value")&gt;   <span style="float: right"><a title="Documentation for this format" href="formats.html"><img src="help.png" alt="doco"/></a></span>
   &lt;<u><b title="Formal Definition (must be supported or understood)">nameA</b></u>&gt;<font color="Gray">&lt;!-- </font><font color="brown">1..1</font> <font color="Darkgreen">type</font> <font color="Navy">description of content</font> <font color="Gray"> --&gt;</font>&lt;nameA&gt;
   &lt;<b title="Formal Definition">nameB[x]</b>&gt;<font color="Gray">&lt;!-- </font><font color="deeppink" title="Condition">0..1</font> <font color="darkgreen">type1</font>|<font color="darkgreen">type1</font> <font color="Navy">description</font> <font color="Gray"> --&gt;</font>&lt;/nameB&gt;
   &lt;<b>nameC</b>&gt; <font color="Brown"><font color="Gray">&lt;!-- </font> <b>1..*</b> --&gt;</font>
     &lt;<b>nameD</b>&gt;<font color="Gray">&lt;!-- </font><font color="brown">1..1</font> <font color="darkgreen">type</font>&gt;<font color="navy">Relevant records</font> <font color="Gray"> --&gt;</font>&lt;/nameD&gt;
   &lt;/nameC&gt;
 &lt;name&gt;
</pre>
<p>
Примечания:
</p>
<ul>
 <li>Для создания допустимого XML-экземпляра ресурса, просто замените содержимое элементов и атрибутов допустимыми значениями, как описано в количестве элементов, типовых правилах и содержимом описания, найденного в комментариях к каждому элементу</li>
 <li>Имена ресурсов и элементов являются регистрозависимыми (хотя дубликаты, различающиеся только регистром, никогда не вводились)</li>
 <li>Обратите внимание, что только те свойства, которые представлены как атрибуты, это те, определенные в базовый, лежащий в основе спецификациях, таких как <a href="#atom">Atom (см. ниже)</a>, которая используется в качестве XML-представления  для комплектов, и атрибуты также используются для примитивных значений</li>
 <li>FHIR-элементы всегда находятся в пространстве имен <a href="http://hl7.org/fhir">http://hl7.org/fhir</a>.  Обычно это указывается как пространство имен по умолчанию на корневом элементе. Другие пространства имен, которые встречаются в FHIR-ресурсах, это те, где некоторых внешняя модель содержимого явно введена в модель содержимого ресурса. Например <a href="narrative.html">XHTML встречается в каждом ресурсе</a></li>
 <li>Любой из XML-элементов может иметь атрибут id, служащий в качестве <a href="references.html#idref">цели внутренней ссылки</a>. Атрибут id не показывается в этом формате</li>
 <li>FHIR-элементы никогда не пустые. Если элемент присутствует в ресурсе, он ОБЯЗАН иметь либо атрибут value, элементы-потоки, как определено для его типа, атрибут id, который является <a href="references.html#idref">целевой ссылкой</a> <a href="narrative.html#narrative">описательной части</a>, либо 1 или больше <a href="extensibility.html">расширений</a></li>
 <li>Атрибуты никогда не могут быть пустыми. Либо они отсутствуют, либо присутствуют с по крайней мере одним символом не пробельного содержимого</li>
  <li>XML-комментарии, команды обработки и форматирования не являются частью содержимого ресурса.</li>
  <li>Определение кодировки символов с помощью команды обработки &lt;?xml encoding="" ?&gt; является необязательным, однако рекомендуемым. Другие команды обработки НЕ ДОЛЖНЫ быть включены, за исключением и НЕ ДОЛЖНЫ требоваться в целях правильного понимания и/или настоящего данных или описательной части ресурса.
Приложения МОГУТ сохранять их во время оперирования ресурсами, однако не являются обязательным так делать. Обратите внимание, что цифровые подписи могут зависеть от них (в зависимости от используемого метода каноникализации (canonicalization).</li>
</ul>
<p>
Когда представлен в XML, ресурсы могут быть проверены на правильность схемой и Schematron (см. ниже), однако от операционных систем не требуется это делать (хотя XML ДОЛЖЕН всегда быть правильным по отношению к данной спецификации и схеме и Schematron).
</p>


<a name="bundle"> </a>
<a name="atom"> </a>
<h3>Atom-представление комплекта</h3>
<p>
В XML <a href="extras.html#bundle">комплекты</a> представляются с помощью формата Atom (<a href="http://tools.ietf.org/html/rfc4287" target="_blank">http://tools.ietf.org/html/rfc4287</a>), следуя этому шаблону:
</p>
<pre class="spec">
&lt;feed xmlns="http://www.w3.org/2005/Atom">  <span style="float: right"><a title="Documentation for this format" href="formats.html"><img src="help.png" alt="doco"/></a></span>
  &lt;title&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>1..1</b></span> <span style="color:darkgreen;"><a href="datatypes.html#string">string</a></span> <span style="color:navy;">Text statement of purpose</span><span style="color: Gray"> --&gt;</span>&lt;/title&gt;
  &lt;id&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>1..1</b></span> <span style="color:darkgreen;"><a href="datatypes.html#uri">uri</a></span> <span style="color:navy;">Unique URI for this bundle</span><span style="color: Gray"> --&gt;</span>&lt;/id&gt;
  &lt;link rel="self" href="<span style="color:navy;">[building application url (Service base on REST)]</span>"/&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span><span style="color: Gray"> --&gt;</span>
  &lt;link rel="first" href="<span style="color:navy;">[paging: url for first page of result]</span>"/&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span><span style="color: Gray"> --&gt;</span>
  &lt;link rel="previous" href="<span style="color:navy;">[paging: url for previous page of result]</span>"/&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span><span style="color: Gray"> --&gt;</span>
  &lt;link rel="next" href="<span style="color:navy;">[paging: url for next page of result]</span>"/&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span><span style="color: Gray"> --&gt;</span>
  &lt;link rel="last" href="<span style="color:navy;">[paging: url for last page of result]</span>"/&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span><span style="color: Gray"> --&gt;</span>
  &lt;link rel="fhir-base" href="<span style="color:navy;">[base path to resolve local urls in this bundle]</span>"/&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span><span style="color: Gray"> --&gt;</span>
  &lt;os:totalResults xmlns:os="http://a9.com/-/spec/opensearch/1.1/"&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>0..1</b></span> <span style="color:darkgreen;"><a href="datatypes.html#primitive">integer</a></span> <span style="color:navy;">
              Paging: the total number of results</span><span style="color: Gray"> --&gt;</span>&lt;/os:totalResults&gt;
  &lt;updated&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>1..1</b></span> <span style="color:darkgreen;"><a href="datatypes.html#instant">instant</a></span> <span style="color:navy;">When the bundle was built</span><span style="color: Gray"> --&gt;</span>&lt;/updated&gt;
  &lt;author&gt;<span style="color:Gray;">&lt;!-- 0..1 Who created resource? --&gt;</span>
      &lt;name&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>1..1</b></span> <span style="color:darkgreen;"><a href="datatypes.html#string">string</a></span> <span style="color:navy;">Name of Human or Device that authored the resource</span><span style="color: Gray"> --&gt;</span>&lt;/name&gt;
      &lt;uri&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span> <span style="color:darkgreen;"><a href="datatypes.html#uri">uri</a></span> <span style="color:navy;">Link to the resource for the author</span><span style="color: Gray"> --&gt;</span>&lt;/uri&gt;
  &lt;/author>
 <a name="tags"> </a>&lt;category term="<span style="color:navy;">[Tag Term]</span>" label="<span style="color:navy;">[Tag Label]</span>" scheme="<span style="color:navy;">[Tag Scheme]</span>"/&gt; <span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..*</span><span style="color: Gray"> --&gt;</span>
  &lt;entry&gt;<span style="color:Gray;">&lt;!-- Zero+ --&gt;</span>
    &lt;title&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>1..1</b></span> <span style="color:darkgreen;"><a href="datatypes.html#string">string</a></span> <span style="color:navy;">Text summary of resource content</span><span style="color: Gray"> --&gt;</span>&lt;/title&gt;
    &lt;id&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>1..1</b></span> <span style="color:darkgreen;"><a href="datatypes.html#uri">uri</a></span> <span style="color:navy;">Logical Id (URI) for this resource</span><span style="color: Gray"> --&gt;</span>&lt;/id&gt;
    &lt;link rel="self" href="<span style="color:navy;">Version Specific reference to Resource</span>"&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span><span style="color: Gray"> --&gt;</span>&lt;/link&gt;
    &lt;updated&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>1..1</b></span> <span style="color:darkgreen;"><a href="datatypes.html#instant">instant</a></span> <span style="color:navy;">Last Updated for resource</span><span style="color: Gray"> --&gt;</span>&lt;/updated&gt;
    &lt;published&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span> <span style="color:darkgreen;"><a href="datatypes.html#instant">instant</a></span> <span style="color:navy;">Time resource copied into the feed</span><span style="color: Gray"> --&gt;</span>&lt;/published&gt;
    &lt;author&gt;<span style="color:Gray;">&lt;!-- 0..1 Who created resource? --&gt;</span>
      &lt;name&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>1..1</b></span> <span style="color:darkgreen;"><a href="datatypes.html#string">string</a></span> <span style="color:navy;">Name of Human or Device that authored the resource</span><span style="color: Gray"> --&gt;</span>&lt;/name&gt;
      &lt;uri&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span> <span style="color:darkgreen;"><a href="datatypes.html#uri">uri</a></span> <span style="color:navy;">Link to the resource for the author</span><span style="color: Gray"> --&gt;</span>&lt;/uri&gt;
    &lt;/author>  <!--    &lt;category term="<span style="color:navy;">[Resource Type]</span>" scheme="http://hl7.org/fhir/resource-types"&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>1..1</b></span><span style="color: Gray"> --&gt;</span>&lt;/category&gt;   -->
    <span style="color:Gray;">&lt;!-- </span><span style="color:navy;">Tags affixed to the resource (<span style="color: brown;"><b>0..*</b></span>): </span> <span style="color: Gray"> --&gt; </span>
	&lt;category term="<span style="color:navy;">[Tag Term]</span>" label="<span style="color:navy;">[Tag Label]</span>" scheme="<span style="color:navy;">[Tag Scheme]</span>"/&gt; <span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..*</span><span style="color: Gray"> --&gt;</span>
    &lt;content type="text/xml"&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;"><b>0..1</b></span><span style="color: Gray"> --&gt;</span>
      &lt;<span style="color:navy;">[ResourceName]</span> xmlns="http://hl7.org/fhir">
        <span style="color: Gray">&lt;!-- </span><span style="color: navy">Content for the resource</span><span style="color: Gray"> --&gt;</span>
      &lt;/<span style="color:navy;">[ResourceName]</span>>
    &lt;/content>
    &lt;summary type="xhtml"&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span><span style="color: Gray"> --&gt;</span>
      &lt;div xmlns="http://www.w3.org/1999/xhtml"><span style="color:Gray;">&lt;!-- </span><span style="color:navy;">Narrative from resource</span><span style="color:Gray;"> --&gt;</span>&lt;/div>
    &lt;/summary>
  &lt;/entry&gt;
  &lt;Signature xmlns="http://www.w3.org/2000/09/xmldsig#"&gt;
    <span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span> <span style="color:navy;">Enveloped Digital Signature (see Atom section 5.1)</span><span style="color:Gray;"> --&gt;</span>
  &lt;/Signature&gt;
&lt;/feed&gt;
</pre>
<a name="atom-notes"> </a>
<h4>Примечания</h4>
<ul>
 <li>Логически рассуждая, комплект – это набор ресурсов, которые приготовлены для отсылки куда-то для дальнейшего потребления – "фид" (feed)</li>
 <li>Порядок следования элементов в atom feed не имеет значения (но не entries (элемент, запись, содержимое; введенные данные; входное сообщение, вхождение): порядок entries является важным и может иметь некоторое значение, ассоциированное с ним). Порядок элементов в пространстве имен атома, как задокументировано выше, не требует соблюдения, хотя его придерживаются FHIR reference platforms платформы</li>
 <li>Заглавие для feed и entry является свободным человекочитаемым содержимым. Заглавие entry ДОЛЖНО выводиться из информации, присутствующей в самом ресурсе. Системы могут игнорировать содержимое в заглавии</li> 
 <li>Каждый комплект ДОЛЖЕН иметь уникальный id и этот id ДОЛЖЕН быть допустимым абсолютным <a href="datatypes.html#uri">URI</a>. UUID рекомендуются (urn:uuid:...).</li>
 <li>Элемент entry служит носителем <a href="resources.html#metadata">трех компонентов метаданных ресурса</a>: Id (.id), Version Id (.link), Last Updated (.updated)</li>
 <li>Каждый entry также служит носителем всех Тегов, приписанных ресурсы в элементе category. Элемент category может использоваться другими способами тоже</li>
 <li>entry.id ДОЛЖНО быть абсолютным URL, заключительный элемент которого – логический id ресурса. id  – это версионно-независимая ссылка</li>
 <li>entry.link на себя (The entry.link to self) – это версионно-зависимая ссылка на ресурс.</li>
 <li>Когда используется в <a href="http.html">RESTful реализации</a>, entry.link и entry.id являются URLs ресурса на систему; ссылка на конкретную версию может использоваться как базовые синхронизирующий pub/sub системы, использующие комплект atom c <a href="http.html#history">updates operation</a>. В других ситуациях значение должно быть буквальными (постоянными) ссылками на сервер, если он доступен. </li>
 <li>Обратите внимание, что спецификация atom требует знания автора каждого entry. Если автор сказан в базовом элементе feed , конкретный автор не требуется для каждого entry.</li>
 <li>Автор ресурса не является явным в модели FHIR ресурса; вместо этого он делегируется к инфраструктуре. Имя – это имя человека-автора или устройства. uri – ссылка на автора (возможно ресурс Practitioner). </li> 
 <li>Элементы xml:base НЕ ДОЛЖНЫ использоваться и реализаторам не требуется поддерживать их.</li>
 <li>entry.content является необязательным, но ДОЛЖЕН всегда присутствовать, за исключением особого случая отклика на транзакцию (transaction response). </li>
 <li>Весь комплект может быть подписан одной Enveloped Digital Signature, как описано в спецификации Atom (раздел 5.1).</li>
 <li>Элемент feed.link с relationship "self" не назначено конкретного значения в FHIR спецификации, за исключением случая операции поиска, однако может использоваться для предоставления ссылка на источник feed</li>
 <li>Элементы feed.link с типом связи relationship "first", "last", "previous" и "next" используются для реализации пейджинга в интерфейсе RESTful и позволяют клиенту рассматривать читать многостраничный результат. См. <a href="search.html">search/query</a></li>
 <li>Элемент feed.link "fhir-base" используется для разрешения относительных ссылок в комплекте, см. <a href="references.html#atom-rel">относительные ссылки</a></li>
</ul>

<a name="atom-deleted"> </a>
<h4>Версии комплектации – удаление</h4>
<p>
При возвращении набора ресурсов или версий ресурса, entry может указывать, что запись была <i>удалена</i>. Удаленные ресурсы представляются в atom feed по правилам, определенным в <a href="http://www.rfc-editor.org/rfc/rfc6721.txt">rfc6721.txt</a>: 
</p>
<pre class="spec">
&lt;feed xmlns="http://www.w3.org/2005/Atom">  <span style="float: right"><a title="Documentation for this format" href="formats.html"><img src="help.png" alt="doco"/></a></span>
  <span style="color:Gray;">... feed elements and other entries ...</span>
  &lt;at:deleted-entry xmlns:at="http://purl.org/atompub/tombstones/1.0"
      ref="<span style="color:navy;">[Logical Id for deleted resource]</span>" when="<span style="color:navy;"><span style="color:darkgreen;"><a href="datatypes.html#instant">instant</a></span> [when deleted]</span>"&gt;
    &lt;link rel="self" href="<span style="color:navy;">[Version Specific reference to Resource]</span>"&gt;<span style="color:Gray;">&lt;!-- </span><span style="color: brown;">0..1</span><span style="color:Gray;"> --&gt;</span>&lt;/link&gt;
  &lt;/at:deleted-entry>
  <span style="color:Gray;">... other entries ...</span>
</pre>
<p>
Удаленный ресурс возвращает ошибку 410 Gone, если обратиться к нему через интерфейс RESTful.
</p>

<a name="atom-impl"> </a>
<h3>Примечания к реализации</h3>
<a name="digsig"> </a>
<ul>
<li>Atom Feeds могут быть подписаны по правилам, описанным в спецификации к Atom. Одним из последствий подписания документа является то, что URL-адреса, идентификаторы и внутренние ссылки замораживаются и не могут быть изменены. Это может быть желаемым свойством, но может также лишить закрытые экосистемы, где часто происходит <a href="use.html#identity">повторное определение (re-identification)</a>, способности к взаимодействию. По этой причине рекомендуется подписывать только Комплекты документов (Document Bundles) и только после того, как все связанные ресурсы находятся в комплекте. </li>
<li>
<a name="Ids"></a>
Ресурсы FHIR пользуются id-атрибутами в качестве целей <a href="references.html#idref">внутренних ссылок с ресурсами</a>. 
Эти id-атрибуты являются уникальными и разрешаются в пределах контекста одного ресурса. Когда ресурсы комбинируются в комплект, могут возникнуть дубликаты: различные ресурсы могут содержать одинаковые id-атрибуты. Поэтому важно ограничить область разрешения id-атрибута ресурсом, в котором этот <i>id</i>-атрибут  объявлен.
</li>
</ul>


<a name="binary"> </a>
<h4>Бинарные ресурсы</h4>
<p>
Когда <a href="extras.html#binary">бинарный ресурс</a> описывается в виде XML в ATOM feed, он представляется base64-закодированным содержимым наряду с указанием типа содержимого, который является MIME-типом, как это обычно указывается в HTTP:
</p>
<pre class="spec">
 &lt;Binary xmlns="http://hl7.org/fhir" contentType="<span style="color:navy;">[mime type]</span>"&gt;  <span style="float: right"><a title="Documentation for this format" href="formats.html"><img src="help.png" alt="doco"/></a></span>
   <span style="color:navy;">[Base64 Content]</span>
 &lt;/Binary&gt;
</pre>
<p>
Бинарные ресурсы также могут быть встроены как <a href="references.html#contained">вложенные ресурсы</a>.  
Если есть желание сохранить метаданные о бинарном объекте, то необходимо использовать подходящий тип ресурса, например
<a href="documentreference.html">DocumentReference</a> или <a href="media.html">Media</a>.
</p>



<a name="schema"> </a>
<h3>XML-схема и Schematron</h3>
<p>
Данная спецификация предоставляет определения схемы для всех моделей содержимого, описанных здесь. Базовая схема называется "<a href="fhir-base.xsd">fhir-base.xsd</a>" и определяет все типы данных, а также базовые инфраструктурные типы, описанные на этой странице. В дополнение имеется схема для каждого ресурса и общая схема <a href="fhir-all.xsd">fhir-all.xsd</a>, которая включает все схемы ресурса. Модифицированная ATOM-схема <a href="fhir-atom.xsd">fhir-atom.xsd</a>
приводится для проверки правильности <a href="#atom">комплектов</a>.
</p>
<p>
В дополнение к файлам w3c-схемы, данная спецификация также приводит Schematron-файлы, которые 
вводят в действие различные ограничения, определенные для типов данных и ресурсов. Они укомплектованы в виде файлов для каждого ресурса вместе с совместным файлом fhir-atom.sch, содержащим в себе правила для всех ресурсов.
</p>
<p>
Обмениваемый XML ДОЛЖЕН быть проверен на соответствие схеме w3c и Schematron, хотя соответствие схеме и Schematron не является достаточным, чтобы быть совместимым экземпляром: данная спецификация вводит несколько правил, которые не могут быть проверены никакими механизмами. Обмениваемое содержимое не должно задавать схему или даже пространство имен экземпляра схемы в самом ресурсе.
</p>

<!-- Todo: Relax NG, RDF, eCore -->


</div>

[%file newfooter%]
</body>
</html>