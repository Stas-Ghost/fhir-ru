<!DOCTYPE HTML>


      
[%settitle Описательная часть%]
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
[%file newheader%]
</head>
<body>
[%file newnavbar%]

<div class="col-9">



<a name="root"> </a>
<a name="Narrative"> </a>
<a name="narrative"> </a>
<a name="xhtml"> </a>
<h2>Описательная часть</h2>
<p>
Каждый ресурс может содержать человекочитаемую описательную часть, которая содержит краткое изложение ресурса и может быть использована для представления содержимого ресурса человеку. Если описательная часть присутствует, она ДОЛЖНА отражать все содержимое, необходимое человеку для понимания важнейшей клинической и деловой информации, которая закодирована в ресурсе. Определения ресурса могут устанавливать, какие данные следует представлять в описательной части для гарантирования клинической безопасности.
</p>
<p>
Описательная часть ресурса может содержать дополнительную информацию, которой нет в структурированных данных, включая отредактированное человеком содержимое. Дополнительная информация ДОЛЖНА входить в область определения ресурса, хотя для описательной части характерно включать дополнительные данные, извлеченные из других упоминаемых ресурсов, на которые имеются ссылки.
</p>
<p>
Ресурсы ДОЛЖНЫ всегда содержать описательную часть для поддержки использования человеком в качестве запасного варианта. Тем не менее, в строго управляемых системах торговли, где все системы разделяют общую модель данных и дополнительный текст является излишним или даже несет в себе риск клинической безопасности, описательная часть может быть опущена. Реализаторы должны тщательно взвесить это решение, перед тем как принимать его, т.к. это будет означать, что эти ресурсы смогут быть поняты только в ограниченной торговой среде. Весьма вероятно, что закрытые торговые партнерские среды откроются в течение жизненного срока ресурсов, которые они определяют. К тому же, большинство шагов рабочего процесса, включая нахождение и агрегацию ресурсов, являются намного более сложными и трудоемкими, если используемые ресурсы не имеют собственного текста.
</p>
<p>
Обратите внимание, что <a href="references.html#contained">вложенные</a> ресурсы НЕ ДОЛЖНЫ иметь собственной описательной части.
</p>
<p>
Описательная часть - это фрагмент XHTML с флагом для указания ее связи с данными:
</p>
[%dt Narrative%]
<a name="security"> </a>
<p>
Содержимое элемента <i>div</i>  – это фрагмент XHTML, который ДОЛЖЕН содержать только базовые HTML-атрибуты форматирования, описанные в главах 7-11 (кроме раздела 4 главы 9) и 15 стандарта HTML 4.0 , элементы &lt;a&gt; (name либо href), изображения и внутренние атрибуты стилей. Содержимое XHTML НЕ ДОЛЖНО включать в себя элементы head и body, ссылки на внешние таблицы стилей, не рекомендуемые элементы, скрипты, формы, base/link/xlink, фреймы, iframes, объекты и атрибуты, связанные с событиями (например onClick). Это гарантирует, что содержимое описательной части содержится внутри ресурса и в нем отсутствует активный контент, иначе это ввело бы проблемы безопасности и, потенциально, проблемы надежности касательно извлекаемого из XHTML текста.
</p>
<p>
Элемент div ДОЛЖЕН иметь некоторое не пробельное содержимое (текст или изображение).
</p>
<div class="example">
<pre class="xml" fragment="Narrative">
  &lt;narrative&gt;
    &lt;div xmlns="http://www.w3.org/1999/xhtml"&gt;This is a simple 
          example with only plain text&lt;/div&gt;
  &lt;/narrative&gt;
   
   &lt;narrative&gt;
   &lt;div xmlns="http://www.w3.org/1999/xhtml"&gt;
     &lt;p&gt;
       This is an &lt;i&gt;example&lt;/i&gt; with some &lt;b&gt;xhtml&lt;/b&gt; formatting.
     &lt;/p&gt;
   &lt;/div&gt;
  &lt;/narrative&gt;
</pre>
</div>
<p>
Внутренняя часть содержимого элемента div часто берется для свойства innerHTML в браузере. В целях упрощения этого вида обработки, когда описательная часть представлена в формате JSON, она ДОЛЖНА быть закодирована таким образом, чтобы между первым "&gt;" и последним 
"&lt;" символами было только содержимое элемента &lt;div&gt;, например
</p>
<pre class="json">
  &quot;div&quot;: &quot;&lt;div&gt;text&lt;/div&gt;&quot;
</pre>
<p>
допустимо, но не:
</p>
<pre class="json">
  &quot;div&quot;: &quot;&lt;?xml ...&gt;&lt;div&gt;text&lt;/div&gt;&quot;
</pre>
<p>
Обратите внимание, что XHTML-содержимое входит в общий XML, поэтому нет поддержки таких сущностей HTML, как &amp;nbsp; &amp;copy; и др. Вместо них СЛЕДУЕТ использовать символы Юникода. Юникод 
&amp;#160; заменяет &amp;nbsp;. 
</p>
<p>
Содержимое описательной части ДОЛЖНО быть на <a href="base-definitions.html#Resource.language">языке ресурса</a>, но нет основания ожидать, что HTML-обработчик распознает элемент ресурса <a href="resources.html#content">language</a>. По этой причине СЛЕДУЕТ использовать атрибут lang элемента &lt;div&gt; (и см. <a href="http://www.w3.org/html/wg/drafts/html/master/dom.html#the-lang-and-xml:lang-attributes">примечание в спецификации HTML 5 об использовании language</a>).
</p>

<p>
Ссылки на источник изображения могут быть локальными ссылками внутри ресурса:
</p>
<pre class="xml">
  &lt;img src="#a5"/&gt;
</pre>
<p>
Это <a href="references.html#idref">внутренняя ссылка</a> на атрибут id элемента в этом же ресурсе - это будет либо элемент типа "<a href="datatypes.html#Attachment">Attachment</a>", либо вложенный <a href="extras.html#binary">Binary</a> ресурс.
</p>
<div class="example">
<pre class="xml">
&lt;Patient xmlns=&quot;http://hl7.org/fhir&quot;&gt;
  &lt;text&gt;
    &lt;status value=&quot;generated&quot;/&gt;
    &lt;div xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
      &lt;p&gt;... &lt;img src=&quot;#pic1&quot;/&gt;. ....&lt;/p&gt;
    &lt;/div&gt;
  &lt;/text&gt;
  &lt;contained&gt;
    &lt;Binary id=&quot;pic1&quot; contentType=&quot;image/gif&quot;&gt;MEKH....SD/Z&lt;/Binary&gt;
  &lt;/contained&gt;
</pre>
</div>
<p>
Из-за невозможности гарантировать доступность изображений, содержащихся вне ресурса, при показе ресурса пользователю источник любых изображений, являющихся важной частью описания ресурса, всегда ДОЛЖЕН быть встроен во вложение или вложенный ресурс.
</p>

<a name="css"></a>
<h3>Художественное оформление XHTML</h3>
<p>
XHTML-фрагмент в описательной части может быть оформлен с помощью каскадных таблиц стилей, используя внешние или внутренние стили. Внешние стили применяются с помощью атрибутов <i>class</i> 
и <i>id</i> XHTML-элементов, внутренние стили применяются с помощью использования атрибута <i>style</i> прямо на элементах XHTML. 
</p>
<p>
В целях минимизации проблем управляемости и безопасности, авторские системы не задают CSS для использования напрямую; вместо этого таблицы стилей предоставляет приложение, отображающее ресурс. Это значит, что система визуализации выбирает, какие стили могут быть использованы, однако авторская система должна использовать их заранее. Авторские системы могут использовать следующие классы, которые ДОЛЖНЫ поддерживаться всеми системами отображения:
</p>
<table>
 <tr> <td>bold</td> <td>Полужирный шрифт</td> <td>{ font-weight: bold }</td> </tr>
 <tr> <td>italics</td> <td>Курсивный шрифт</td> <td>{ font-style: italic }</td> </tr>
 <tr> <td>underline</td> <td>Подчеркнутый текст</td> <td>{ text-decoration: underline }</td> </tr>
 <tr> <td>strikethrough</td> <td>Перечеркнутый текст</td> <td>{ text-decoration: line-through }</td> </tr>
 <tr> <td>left</td> <td>Выравнивание по левому краю</td> <td>{ text-align : left }</td> </tr>
 <tr> <td>right</td> <td>Выравнивание по правому краю</td> <td>{ text-align : right }</td> </tr>
 <tr> <td>center</td> <td>Выравнивание по центру</td> <td>{ text-align : center }</td> </tr>
 <tr> <td>justify</td> <td>Выравнивание по ширине</td> <td>{ text-align : justify }</td> </tr>
 <tr> <td>border-left</td> <td>Граница слева</td> <td>{ border-left: 1px solid grey }</td> </tr>
 <tr> <td>border-right</td> <td>Граница справа</td> <td>{ border-right: 1px solid grey }</td> </tr>
 <tr> <td>border-top</td> <td>Граница сверху</td> <td>{ border-top: 1px solid grey }</td> </tr>
 <tr> <td>border-bottom</td> <td>Граница снизу</td> <td>{ border-bottom: 1px solid grey }</td> </tr>
 <tr> <td>arabic</td> <td>Нумерация списка арабскими цифрами: 1, 2, 3</td> <td>{ list-style-type: decimal }</td> </tr>
 <tr> <td>little-roman</td> <td>Нумерация списка маленькими римскими цифрами: i, ii, iii</td> <td>{ list-style-type: lower-roman }</td> </tr>
 <tr> <td>big-roman</td> <td>Нумерация списка большими римскими цифрами: I, II, III</td> <td>{ list-style-type: upper-roman }</td> </tr>
 <tr> <td>little-alpha</td> <td>Нумерация списка маленькими символами латиницы: a, b, c</td> <td>{ list-style-type: lower-alpha }</td> </tr>
 <tr> <td>big-alpha</td> <td>Нумерация списка большими символами латиницы: A, B, C</td> <td>{ list-style-type: upper-alpha }</td> </tr>
 <tr> <td>disc</td> <td>Маркеры списка - простые закрашенные кружочки</td> <td>{ list-style-type: disc }</td> </tr>
 <tr> <td>circle</td> <td>Маркеры списка - не закрашенные кружочки</td> <td>{ list-style-type : circle }</td> </tr>
 <tr> <td>square</td> <td>Маркеры списка - закрашенные квадратики</td> <td>{ list-style-type: square }</td> </tr>
</table>
<p>
Примечание: для тестирования имеется <a href="other-example-narrative.xml.html">пример ресурса</a> с использованием всех этих стилей. Также для этого ресурса доступно <a href="narrative-example.html">XHTML-представление</a> и 
<a href="fhir-runtime.css">стандартная таблица стилей</a>, содержащая все эти стили. 
</p>

<p>
Авторские системы могут ссылаться на дополнительные классы, но не могут полагаться на тот факт, что они будут поддержаны. Если использование дополнительных классов критично для безопасного отображения, тогда потребуются соглашения торговых партнеров. 
</p>
<p>
Кроме того, авторские системы могут использовать внутренние стили с помощью атрибута <i>style</i>. Этот подход имеет преимущество - независимость от внешней интерпретации, но также имеет побочный эффект, усложняя управление содержимым во время рендеринга, поэтому приложениям следует использовать этот подход с осторожностью. Авторские системы могут устанавливать следующие аспекты оформления содержимого:
</p>
<ul>
  <li>полужирный, курсив, подчеркнутый, перечеркнутый</li>
  <li>цвет, семейство и размер шрифта</li>
  <li>цвет фона, выравнивание текста</li>
  <li>интерпретация символов табуляции</li>
  <li>формат нумерации упорядоченного списка (т. к. на него могут быть ссылки в тексте)</li>
</ul>
<p>
Эти свойства стиля указываются внутри элементов с помощью атрибута style. Отображающие системы ДОЛЖНЫ соблюдать все эти стили отображения, когда они указаны в атрибуте style, хотя допустима подходящая интерпретация (например позволяется соответствующим образом настраивать цвета для вывода низкоконтрастного отображения в случае темной комнаты или высококонтрастного отображения для слабовидящих).
</p>
<p>
Обратите внимание, что системам отображения допускается игнорировать или переписывать любой из внутренних или внешних стилей, описанных выше, но осторожно, чтобы гарантировать, что это делается только в случае хорошо поддерживаемых торговых партнерских соглашений, т. к. изменение отображения текста может создать проблемы клинической безопасности.
</p>
<p>
Авторы МОГУТ вводить дополнительные стили и свойства стилей, как описано в CSS-спецификации, однако они являются расширениями к данной спецификации, и от программ отображения не требуется обрабатывать их. Просмотр описательной части в случает недоступности этих дополнительные возможностей оформления ДОЛЖЕН быть безопасным.
</p>
<p>
Обратите внимание, что имеются дополнительные правила оформления представления <a href="documents.html#css">документов</a>.
</p>

<a name="safety"> </a>
<h3>Соображения клинической безопасности</h3>
<p>
Документы здравоохранения часто связаны с законодательными и профессиональными требованиями к 
очень продолжительному времени сохранения (до века) и крайним неприятием риска противоречивого отображения на различных устройствах. Несмотря на то, что в описательной части позволяется использовать стандарт XHTML и свойства CSS, как описано выше, разработчикам поощряется умеренное использование доступных свойств. Даже когда торговые партнерские соглашения вводят ограничения поверх текущих требований системы, опыт показывает, что эти договоренности будут постепенно расширяться с течением времени.
</p>
<p>
В частности:
</p>
<ul>
 <li>Сложные многоуровневые разметки, требующие тщательного тестирования на соответствие между XHTML-элементами <i>div</i> и <i>span</i> и стилями, и те, что содержат вложенные таблицы (возможно, с изображениями) точно так же затрудняют последовательность отображения, и разработчикам СЛЕДУЕТ избегать их.</li>
 <li>Использование стилей, например полужирный, курсив или цвет, НЕ ДОЛЖНО употребляться в качестве единственного способа передачи смысла или семантики, а должно применяться наряду с другими FHIR-ресурсами для обеспечения последовательной долгосрочной совместимости.</li>
</ul>
</div>

[%file newfooter%]
</body>
</html>