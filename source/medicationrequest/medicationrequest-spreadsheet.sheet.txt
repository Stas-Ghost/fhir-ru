
=== Sheet Bindings =====================================

 -- Row 1 -----------------------------------
  Binding Name = MedicationIntendedSubstitutionReason
  Binding = value set
  Reference = http://hl7.org/fhir/ValueSet/v3-SubstanceAdminSubstitutionReason
  Definition = A coded concept describing the reason that a different medication should (or should not) be substituted from what was prescribed.
  Description = SubstanceAdminSubstitutionReason
  Conformance = example

 -- Row 2 -----------------------------------
  Binding Name = MedicationAsNeededReason
  Binding = value set
  Reference = valueset-medication-as-needed-reason
  Definition = A coded concept identifying the precondition that should be met or evaluated prior to consuming or administering a medication dose.  For example \"pain\", \"30 minutes prior to sexual intercourse\", \"on flare-up\" etc.
  Conformance = example

 -- Row 3 -----------------------------------
  Binding Name = MedicationAdministrationSite
  Binding = value set
  Reference = http://hl7.org/fhir/ValueSet/approach-site-codes
  Definition = A coded concept describing the site location the medicine enters into or onto the body.
  Conformance = example

 -- Row 4 -----------------------------------
  Binding Name = MedicationAdministrationMethod
  Binding = value set
  Reference = valueset-administration-method-codes
  Definition = A coded concept describing the technique by which the medicine is administered.
  Conformance = example

 -- Row 5 -----------------------------------
  Binding Name = MedicationRequestStatus
  Binding = code list
  Reference = #medication-request-status
  Definition = A coded concept specifying the state of the prescribing event. Describes the lifecycle of the prescription
  Conformance = required
  v3 = ActStatus

 -- Row 6 -----------------------------------
  Binding Name = RouteOfAdministration
  Binding = value set
  Reference = valueset-route-codes
  Definition = A coded concept describing the route or physiological path of administration of a therapeutic agent into or onto the body of a subject.
  Conformance = example

 -- Row 7 -----------------------------------
  Binding Name = MedicationRequestIntent
  Binding = code list
  Reference = #medication-request-intent
  Definition = The kind of medication order
  Conformance = required

 -- Row 8 -----------------------------------
  Binding Name = MedicationRequestReason
  Binding = value set
  Reference = http://hl7.org/fhir/ValueSet/condition-code
  Definition = A coded concept indicating why the medication was ordered.
  Conformance = example

 -- Row 9 -----------------------------------
  Binding Name = MedicationCode
  Binding = value set
  Reference = http://hl7.org/fhir/ValueSet/medication-codes
  Definition = A coded concept identifying substance or product that can be ordered.
  Conformance = example

 -- Row 10 -----------------------------------
  Binding Name = AdditionalInstructions
  Binding = value set
  Reference = valueset-additional-instruction-codes
  Definition = A coded concept identifying additional instructions such as \"take with water\" or \"avoid operating heavy machinery\".
  Conformance = example

 -- Row 11 -----------------------------------
  Binding Name = MedicationRequestAction
  Binding = unbound
  Definition = A coded concept describing an action taken on a medication order.

 -- Row 12 -----------------------------------
  Binding Name = MedicationRequestActionReason
  Binding = unbound
  Definition = A coded concept describing the reason for an action taken on a medication order.

 -- Row 13 -----------------------------------
  Binding Name = MedicationRequestCategory
  Binding = code list
  Reference = #medication-request-category
  Definition = A coded concept identifying the category of medication request.  For example, where the medication is to be consumed or administered, or the type of medication treatment).
  Conformance = example

 -- Row 14 -----------------------------------
  Binding Name = MedicationRequestPriority
  Binding = code list
  Reference = #medication-request-priority
  Definition = Identifies the level of importance to be assigned to actioning the request
  Conformance = required

 -- Row 15 -----------------------------------
  Binding Name = MedicationRequestPerformerType
  Binding = value set
  Reference = valueset-medication-request-performer-type
  Definition = Identifies the type of individual that is desired to administer the medication
  Conformance = example

 -- Row 16 -----------------------------------
  Binding Name = MedicationRequestStatusReason
  Binding = code list
  Reference = #med-request-status-reason
  Definition = Identifies the reasons for a given status
  Conformance = example

 -- Row 17 -----------------------------------
  Binding Name = MedicationRequestPerformerType
  Binding = value set
  Reference = http://hl7.org/fhir/ValueSet/performer-role
  Definition = Identifies the type of performer for the administration of the medication
  Conformance = example

=== Sheet medication-request-status =====================================

 -- Row 1 -----------------------------------
  Id = 1
  Code = active
  Display = Active
  Definition = The prescription is \'actionable\', but not all actions that are implied by it have occurred yet.
  v3 = ActStatus.active

 -- Row 2 -----------------------------------
  Id = 2
  Code = on-hold
  Display = On Hold
  Definition = Actions implied by the prescription are to be temporarily halted, but are expected to continue later.  May also be called \"suspended\".
  v3 = ActStatus.suspended

 -- Row 3 -----------------------------------
  Id = 3
  Code = cancelled
  Display = Cancelled
  Definition = The prescription has been withdrawn.
  v3 = ActStatus.cancelled

 -- Row 4 -----------------------------------
  Id = 4
  Code = completed
  Display = Completed
  Definition = All actions that are implied by the prescription have occurred.
  v3 = ActStatus.completed

 -- Row 5 -----------------------------------
  Id = 5
  Code = entered-in-error
  Display = Entered In Error
  Definition = The prescription was entered in error.
  v3 = ActStatus.nullified

 -- Row 6 -----------------------------------
  Id = 6
  Code = stopped
  Display = Stopped
  Definition = Actions implied by the prescription are to be permanently halted, before all of them occurred.
  v3 = ActStatus.aborted

 -- Row 7 -----------------------------------
  Id = 7
  Code = draft
  Display = Draft
  Definition = The prescription is not yet \'actionable\', i.e. it is a work in progress, requires sign-off or verification, and needs to be run through decision support process.
  v3 = ActStatus.new

 -- Row 8 -----------------------------------
  Id = 8
  Code = unknown
  Display = Unknown
  Definition = The authoring system does not know which of the status values currently applies for this request

=== Sheet medication-request-intent =====================================

 -- Row 1 -----------------------------------
  Id = 1
  Code = proposal
  Display = Proposal
  Definition = The request is a suggestion made by someone/something that doesn\'t have an intention to ensure it occurs and without providing an authorization to act

 -- Row 2 -----------------------------------
  Id = 2
  Code = plan
  Display = Plan
  Definition = The request represents an intension to ensure something occurs without providing an authorization for others to act

 -- Row 3 -----------------------------------
  Id = 3
  Code = order
  Display = Order
  Definition = The request represents a request/demand and authorization for action

 -- Row 4 -----------------------------------
  Id = 4
  Code = instance-order
  Display = Instance Order
  Definition = The request represents an instance for the particular order, for example a medication administration record.

 -- Row 5 -----------------------------------
  Id = 5
  Code = option
  Display = Option
  Definition = The request represents a component or opiton for a RequestGroup that establishes timing, conditionality and/or  other constraints among a set of requests.

=== Sheet medication-request-category =====================================

 -- Row 1 -----------------------------------
  Id = 1
  Code = inpatient
  Display = Inpatient
  Definition = Includes orders for medications to be administered or consumed in an inpatient or acute care setting

 -- Row 2 -----------------------------------
  Id = 2
  Code = outpatient
  Display = Outpatient
  Definition = Includes orders for medications to be administered or consumed in an outpatient setting (for example, Emergency Department, Outpatient Clinic, Outpatient Surgery, Doctor\'s office)

 -- Row 3 -----------------------------------
  Id = 3
  Code = community
  Display = Community
  Definition = Includes orders for medications to be administered or consumed by the patient in their home (this would include long term care or nursing homes, hospices, etc)

=== Sheet medication-request-priority =====================================

 -- Row 1 -----------------------------------
  Id = 1
  Code = routine
  Display = Routine
  Definition = The order has a normal priority .

 -- Row 2 -----------------------------------
  Id = 2
  Code = urgent
  Display = Urgent
  Definition = The order should be urgently.

 -- Row 3 -----------------------------------
  Id = 3
  Code = stat
  Display = Stat
  Definition = The order is time-critical.

 -- Row 4 -----------------------------------
  Id = 4
  Code = asap
  Display = ASAP
  Definition = The order should be acted on as soon as possible.

=== Sheet med-request-status-reason =====================================

 -- Row 1 -----------------------------------
  Id = 1
  Code = altchoice
  Display = Try another treatment first
  Definition = This therapy has been ordered as a backup to a preferred therapy. This order will be released when and if the preferred therapy is unsuccessful.

 -- Row 2 -----------------------------------
  Id = 2
  Code = clarif
  Display = Prescription requires clarification
  Definition = Clarification is required before the order can be acted upon.

 -- Row 3 -----------------------------------
  Id = 3
  Code = drughigh
  Display = Drug level too high
  Definition = The current level of the medication in the patient\'s system is too high. The medication is suspended to allow the level to subside to a safer level.

 -- Row 4 -----------------------------------
  Id = 4
  Code = hospadm
  Display = Admission to hospital
  Definition = The patient has been admitted to a care facility and their community medications are suspended until hospital discharge.

 -- Row 5 -----------------------------------
  Id = 5
  Code = labint
  Display = Lab interference issues
  Definition = The therapy would interfere with a planned lab test and the therapy is being withdrawn until the test is completed.

 -- Row 6 -----------------------------------
  Id = 6
  Code = non-avail
  Display = Patient not-available
  Definition = Patient not available for a period of time due to a scheduled therapy, leave of absence or other reason.

 -- Row 7 -----------------------------------
  Id = 7
  Code = preg
  Display = Parent is pregnant/breast feeding
  Definition = The patient is pregnant or breast feeding. The therapy will be resumed when the pregnancy is complete and the patient is no longer breastfeeding.

 -- Row 8 -----------------------------------
  Id = 8
  Code = salg
  Display = Allergy
  Definition = The patient is believed to be allergic to a substance that is part of the therapy and the therapy is being temporarily withdrawn to confirm.

 -- Row 9 -----------------------------------
  Id = 9
  Code = sddi
  Display = Drug interacts with another drug
  Definition = The drug interacts with a short-term treatment that is more urgently required. This order will be resumed when the short-term treatment is complete.

 -- Row 10 -----------------------------------
  Id = 10
  Code = sdupther
  Display = Duplicate therapy
  Definition = Another short-term co-occurring therapy fulfills the same purpose as this therapy. This therapy will be resumed when the co-occuring therapy is complete.

 -- Row 11 -----------------------------------
  Id = 11
  Code = sintol
  Display = Suspected intolerance
  Definition = The patient is believed to have an intolerance to a substance that is part of the therapy and the therapy is being temporarily withdrawn to confirm.

 -- Row 12 -----------------------------------
  Id = 12
  Code = surg
  Display = Patient scheduled for surgery
  Definition = The drug is contraindicated for patients receiving surgery and the patient is scheduled to be admitted for surgery in the near future. The drug will be resumed when the patient has sufficiently recovered from the surgery.

 -- Row 13 -----------------------------------
  Id = 13
  Code = washout
  Display = Waiting for old drug to wash out
  Definition = The patient was previously receiving a medication contraindicated with the current medication. The current medication will remain on hold until the prior medication has been cleansed from their system.

=== Sheet Invariants =====================================

=== Sheet Data Elements =====================================

 -- Row 1 -----------------------------------
  Element = MedicationRequest
  Aliases = Prescription; Order
  Type = DomainResource
  Short Name = Ordering of medication for patient or group
  Definition = An order or request for both supply of the medication and the instructions for administration of the medication to a patient. The resource is called \"MedicationRequest\" rather than \"MedicationPrescription\" or \"MedicationOrder\" to generalize the use across inpatient and outpatient settings, including care plans, etc., and to harmonize with workflow patterns.
  Workflow Mapping = Request
  SCRIPT 10.6 Mapping = Message/Body/NewRx
  RIM Mapping = CombinedMedicationRequest
  w5 = clinical.medication

 -- Row 2 -----------------------------------
  Element = MedicationRequest.identifier
  Card. = 0..*
  Type = Identifier
  Short Name = External ids for this request
  Definition = This records identifiers associated with this medication request that are defined by business processes and/or used to refer to it when a direct URL reference to the resource itself is not appropriate. For example a re-imbursement system might issue its own id for each prescription that is created.  This is particularly important where FHIR only provides part of an entire workflow process where records must be tracked through an entire system.
  Workflow Mapping = Request.identifier
  SCRIPT 10.6 Mapping = Message/Header/PrescriberOrderNumber
  v2 Mapping = ORC-2-Placer Order Number / ORC-3-Filler Order Number
  RIM Mapping = .id
  w5 = id

 -- Row 3 -----------------------------------
  Element = MedicationRequest.instantiates
  Card. = 0..*
  Summary = y
  Type = uri
  Short Name = Instantiates protocol or definition
  Definition = The URL pointing to a protocol, guideline, orderset or other definition that is adhered to in whole or in part by this MedicationRequest.
  Workflow Mapping = Request.instantiates
  RIM Mapping = .outboundRelationship[typeCode=DEFN].target[classCode=unspecified]

 -- Row 4 -----------------------------------
  Element = MedicationRequest.basedOn
  Card. = 0..*
  Summary = y
  Type = Reference(CarePlan |MedicationRequest |ServiceRequest)
  Short Name = What request fulfills
  Definition = A plan or request that is fulfilled in whole or in part by this medication request.
  Workflow Mapping = Request.basedOn
  RIM Mapping = .outboundRelationship[typeCode=FLFS].target[classCode=SBADM or PROC or PCPR or OBS, moodCode=RQO orPLAN or PRP]

 -- Row 5 -----------------------------------
  Element = MedicationRequest.groupIdentifier
  Card. = 0..1
  Summary = y
  Type = Identifier
  Short Name = Composite request this is part of
  Definition = A shared identifier common to all requests that were authorized more or less simultaneously by a single author, representing the identifier of the requisition or prescription.
  Requirements = Requests are linked either by a \"basedOn\" relationship (i.e. one request is fulfilling another) or by having a common requisition. Requests that are part of the same requisition are generally treated independently from the perspective of changing their state or maintaining them after initial creation.
  Workflow Mapping = Request.groupIdentifier
  RIM Mapping = .outboundRelationship(typeCode=COMP].target[classCode=SBADM, moodCode=INT].id

 -- Row 6 -----------------------------------
  Element = MedicationRequest.status
  Card. = 0..1
  Is Modifier = Y
  Summary = y
  Type = code
  Binding = MedicationRequestStatus
  Short Name = active | on-hold | cancelled | completed | entered-in-error | stopped | draft | unknown
  Definition = A code specifying the current state of the order.  Generally this will be active or completed state
  Comments = This element is labeled as a modifier because the status contains codes that mark the resource as not currently valid
  Workflow Mapping = Request.status
  SCRIPT 10.6 Mapping = no mapping
  RIM Mapping = .statusCode
  w5 = status

 -- Row 7 -----------------------------------
  Element = MedicationRequest.statusReason
  Card. = 0..1
  Type = CodeableConcept
  Binding = MedicationRequestStatusReason
  Short Name = Reason for current status
  Definition = Captures the reason for the current state of the MedicationRequest
  Comments = This is generally only used for \"exception\" statuses such as \"suspended\" or \"cancelled\". The reason why the MedicationRequest was created at all is captured in reasonCode, not here.
  RIM Mapping = .inboundRelationship[typeCode=SUBJ].source[classCode=CACT, moodCode=EVN].reasonCOde

 -- Row 8 -----------------------------------
  Element = MedicationRequest.intent
  Card. = 1..1
  Is Modifier = y
  Summary = y
  Type = code
  Binding = MedicationRequestIntent
  Short Name = proposal | plan | order | instance-order | option
  Definition = Whether the request is a proposal, plan, or an original order
  Comments = It is expected that the type of requester will be restricted for different stages of a MedicationRequest.  For example, Proposals can be created by a patient, relatedPerson, Practitioner or Device.  Plans can be created by Practitioners, Patients, RelatedPersons and Devices.  Original orders can be created by a Practitioner only.\r\rAn instance-order is an instantiation of a request or order and may be used to populate Medication Administration Record.\r\rThis element is labeled as a modifier because the intent alters when and how the resource is actually applicable
  Workflow Mapping = Request.intent
  RIM Mapping = .moodCode (nuances beyond PRP/PLAN/RQO would need to be elsewhere)
  w5 = class

 -- Row 9 -----------------------------------
  Element = MedicationRequest.category
  Card. = 0..*
  Type = CodeableConcept
  Binding = MedicationRequestCategory
  Short Name = Type of medication usage
  Definition = Indicates the type of medication request (for example, where the medication is expected to be consumed or administered (i.e. inpatient or outpatient) or the type of treatment (i.e. chemotherapy or endocrine).
  Comments = The category can be used to include treatment types (e.g. chemotherapy or endocrine) or where the medication is expected to be consumed or other types of requests.  Invariants can be used to bind to different value sets when profiling to bind.
  SCRIPT 10.6 Mapping = Message/Body/NewRx/MedicationPrescribed/Directions\r\ror \r\rMessage/Body/NewRx/MedicationPrescribed/StructuredSIG
  RIM Mapping = .inboundRelationship[typeCode=COMP].source[classCode=OBS, moodCode=EVN, code=\"type of medication usage\"].value
  w5 = class

 -- Row 10 -----------------------------------
  Element = MedicationRequest.priority
  Card. = 0..1
  Summary = y
  Type = code
  Binding = MedicationRequestPriority
  Short Name = routine | urgent | stat | asap
  Definition = Indicates how quickly the Medication Request should be addressed with respect to other requests.
  Workflow Mapping = Request.priority
  RIM Mapping = .priorityCode
  w5 = grade

 -- Row 11 -----------------------------------
  Element = MedicationRequest.medication[x]
  Card. = 1..1
  Summary = y
  Type = CodeableConcept|Reference(Medication)
  Binding = MedicationCode
  Short Name = Medication to be taken
  Definition = Identifies the medication being requested. This is a link to a resource that represents the medication which may be the details of the medication or simply an attribute carrying a code that identifies the medication from a known list of medications.
  Comments = If only a code is specified, then it needs to be a code for a specific product. If more information is required, then the use of the medication resource is recommended.  For example, if you require form or lot number or if the medication is compounded or extemporaneously prepared, then you must reference the Medication resource. 
  Workflow Mapping = Request.code
  SCRIPT 10.6 Mapping = Message/Body/NewRx/MedicationPrescribed\r\rMedication.code.coding.code = Message/Body/NewRx/MedicationPrescribed/DrugCoded/ProductCode\r\rMedication.code.coding.system = Message/Body/NewRx/MedicationPrescribed/DrugCoded/ProductCodeQualifier\r\rMedication.code.coding.display = Message/Body/NewRx/MedicationPrescribed/DrugDescription
  v2 Mapping = RXE-2-Give Code / RXO-1-Requested Give Code / RXC-2-Component Code
  RIM Mapping = consumable.administrableMedication
  w5 = what

 -- Row 12 -----------------------------------
  Element = MedicationRequest.subject
  Card. = 1..1
  Summary = y
  Type = Reference(Patient | Group)
  Short Name = Who or group medication request is for
  Definition = A link to a resource representing the person or set of individuals to whom the medication will be given
  Comments = The subject on a medication request is mandatory.  For the secondary use case where the actual subject is not provided, there still must be an anonymized subject specified.
  Workflow Mapping = Request.subject
  SCRIPT 10.6 Mapping = Message/Body/NewRx/Patient\r\r(need detail to link to specific patient … Patient.Identification in SCRIPT)
  v2 Mapping = PID-3-Patient ID List
  RIM Mapping = .participation[typeCode=AUT].role
  w5 = who.focus

 -- Row 13 -----------------------------------
  Element = MedicationRequest.context
  Card. = 0..1
  Type = Reference(Encounter|EpisodeOfCare)
  Short Name = Created during encounter/admission/stay
  Definition = A link to an encounter, or episode of care, that identifies the particular occurrence or set occurrences of contact between patient and health care provider.
  Comments = SubstanceAdministration->component->EncounterEvent
  Workflow Mapping = Request.context
  SCRIPT 10.6 Mapping = no mapping
  v2 Mapping = PV1-19-Visit Number
  RIM Mapping = .inboundRelationship[typeCode=COMP].source[classCode=ENC, moodCode=EVN, code=\"type of encounter or episode\"]
  w5 = context

 -- Row 14 -----------------------------------
  Element = MedicationRequest.supportingInformation
  Card. = 0..*
  Type = Reference(Any)
  Short Name = Information to support ordering of the medication
  Definition = Include additional information (for example, patient height and weight) that supports the ordering of the medication
  RIM Mapping = .outboundRelationship[typeCode=PERT].target[A_SupportingClinicalStatement CMET minimal with many different choices of classCodes(ORG, ENC, PROC, SPLY, SBADM, OBS) and each of the act class codes draws from one or more of the following moodCodes (EVN, DEF, INT PRMS, RQO, PRP, APT, ARQ, GOL)]
  w5 = context

 -- Row 15 -----------------------------------
  Element = MedicationRequest.authoredOn
  Card. = 0..1
  Summary = y
  Type = dateTime
  Short Name = When request was initially authored
  Definition = The date (and perhaps time) when the prescription was initially written or authored on
  Workflow Mapping = Request.authoredOn
  SCRIPT 10.6 Mapping = Message/Body/NewRx/MedicationPrescribed/WrittenDate
  v2 Mapping = RXE-32-Original Order Date/Time / ORC-9-Date/Time of Transaction
  RIM Mapping = author.time
  w5 = when.recorded

 -- Row 16 -----------------------------------
  Element = MedicationRequest.requester
  Card. = 0..1
  Summary = y
  Type = Reference(Practitioner |PractitionerRole | Organization | Patient | RelatedPerson | Device)
  Short Name = Who/What requested the Request
  Definition = The individual, organization or device that initiated the request and has responsibility for its activation.
  Workflow Mapping = Request.requester
  RIM Mapping = .participation[typeCode=AUT].role
  w5 = who.author

 -- Row 17 -----------------------------------
  Element = MedicationRequest.performerType
  Card. = 0..1
  Summary = y
  Type = CodeableConcept
  Binding = MedicationRequestPerformerType
  Short Name = Desired kind of performer of the medication administration
  Definition = Indicates the type of performer of the administration of the medication
  Comments = If specified without indicating a performer, this indicates that the performer must be of the specified type. If specified with a performer then it indicates the requirements of the performer if the designated performer is not available.
  RIM Mapping = .participation[typeCode=PRF].role[scoper.determinerCode=KIND].code

 -- Row 18 -----------------------------------
  Element = MedicationRequest.recorder
  Card. = 0..1
  Type = Reference(Practitioner)
  Short Name = Person who entered the request
  Definition = The person who entered the order on behalf of another individual for example in the case of a verbal or a telephone order.
  RIM Mapping = .participation[typeCode=TRANS].role[classCode=ASSIGNED].code (HealthcareProviderType)
  w5 = who

 -- Row 19 -----------------------------------
  Element = MedicationRequest.performer
  Card. = 0..1
  Type = Reference (Practitioner | PractitionerRole | Organization | Patient | Device |RelatedPerson |CareTeam)
  Short Name = Intended performer of administration
  Definition = The specified desired performer of the medication treatment (e.g. the performer of the medication administration).
  Workflow Mapping = Request.performer
  RIM Mapping = .participation[typeCode=PRF].role[scoper.determinerCode=INSTANCE]
  w5 = who

 -- Row 20 -----------------------------------
  Element = MedicationRequest.reasonCode
  Card. = 0..*
  Type = CodeableConcept
  Binding = MedicationRequestReason
  Short Name = Reason or indication for writing the prescription
  Definition = The reason or the indication for ordering the medication.
  Comments = This could be a diagnosis code. If a full condition record exists or additional detail is needed, use reasonReference.
  Workflow Mapping = Request.reasonCode
  SCRIPT 10.6 Mapping = Message/Body/NewRx/MedicationPrescribed/Diagnosis/Primary/Value
  v2 Mapping = ORC-16-Order Control Code Reason /RXE-27-Give Indication/RXO-20-Indication / RXD-21-Indication / RXG-22-Indication / RXA-19-Indication
  RIM Mapping = reason.observation.reasonCode
  w5 = why

 -- Row 21 -----------------------------------
  Element = MedicationRequest.reasonReference
  Card. = 0..*
  Type = Reference(Condition |Observation)
  Short Name = Condition or Observation that supports why the prescription is being written
  Definition = Condition or observation that supports why the medication was ordered
  Comments = This is a reference to a condition or observation that is the reason for the medication order.  If only a code exists, use reasonCode.
  Workflow Mapping = Request.reasonReference
  SCRIPT 10.6 Mapping = no mapping
  RIM Mapping = reason.observation[code=ASSERTION].value
  w5 = why

 -- Row 22 -----------------------------------
  Element = MedicationRequest.insurance
  Card. = 0..*
  Type = Reference (Coverage | ClaimResponse)
  Short Name = Associated insurance coverage
  Definition = Insurance plans, coverage extensions, pre-authorizations and/or pre-determinations that may be in delivering the requested service.
  RIM Mapping = .outboundRelationship[typeCode=COVBY].target

 -- Row 23 -----------------------------------
  Element = MedicationRequest.note
  Card. = 0..*
  Type = Annotation
  Short Name = Information about the prescription
  Definition = Extra information about the prescription that could not be conveyed by the other attributes.
  Workflow Mapping = Request.note
  SCRIPT 10.6 Mapping = Message/Body/NewRx/MedicationPrescribed/Note
  RIM Mapping = .inboundRelationship[typeCode=SUBJ]/source[classCode=OBS,moodCode=EVN,code=\"annotation\"].value

 -- Row 24 -----------------------------------
  Element = MedicationRequest.dosageInstruction
  Card. = 0..*
  Type = Dosage
  Short Name = How the medication should be taken
  Definition = Indicates how the medication is to be used by the patient.
  Comments = There are examples where a medication request may include the option of an oral dose or an Intravenous or Intramuscular dose.  For example, \"Ondansetron 8mg orally or IV twice a day as needed for nausea\" or \"Compazine® (prochlorperazine) 5-10mg PO or 25mg PR bid prn nausea or vomiting\".  In these cases, two medication requests would be created that could be grouped together.  The decision on which dose and route of administration to use is based on the patient\'s condition at the time the dose is needed.
  Workflow Mapping = Request.occurrence[x]
  RIM Mapping = see dosageInstruction mapping

 -- Row 25 -----------------------------------
  Element = MedicationRequest.dispenseRequest
  Card. = 0..1
  UML = 300;400
  Short Name = Medication supply authorization
  Definition = Indicates the specific details for the dispense or medication supply part of a medication request (also known as a Medication Prescription or Medication Order).  Note that this information is not always sent with the order.  There may be in some settings (e.g. hospitals) institutional or system support for completing the dispense details in the pharmacy department.
  SCRIPT 10.6 Mapping = Message/Body/NewRx/MedicationPrescribed/ExpirationDate
  RIM Mapping = component.supplyEvent

 -- Row 26 -----------------------------------
  Element = MedicationRequest.dispenseRequest.validityPeriod
  Card. = 0..1
  Type = Period
  Short Name = Time period supply is authorized for
  Definition = This indicates the validity period of a prescription (stale dating the Prescription)
  Requirements = Indicates when the Prescription becomes valid, and when it ceases to be a dispensable Prescription.
  Comments = It reflects the prescribers\' perspective for the validity of the prescription. Dispenses must not be made against the prescription outside of this period. The lower-bound of the Dispensing Window signifies the earliest date that the prescription can be filled for the first time. If an upper-bound is not specified then the Prescription is open-ended or will default to a stale-date based on regulations.
  SCRIPT 10.6 Mapping = Message/Body/NewRx/MedicationPrescribed/Refills
  RIM Mapping = effectiveTime

 -- Row 27 -----------------------------------
  Element = MedicationRequest.dispenseRequest.numberOfRepeatsAllowed
  Card. = 0..1
  Type = unsignedInt
  Short Name = Number of refills authorized
  Definition = An integer indicating the number of times, in addition to the original dispense, (aka refills or repeats) that the patient can receive the prescribed medication. Usage Notes: This integer does not include the original order dispense. This means that if an order indicates dispense 30 tablets plus \"3 repeats\", then the order can be dispensed a total of 4 times and the patient can receive a total of 120 tablets.  A prescriber may explicitly say that zero refills are permitted after the initial dispense.
  Comments = If displaying \"number of authorized fills\", add 1 to this number.
  SCRIPT 10.6 Mapping = Message/Body/NewRx/MedicationPrescribed/Quantity
  v2 Mapping = RXE-12-Number of Refills
  RIM Mapping = repeatNumber

 -- Row 28 -----------------------------------
  Element = MedicationRequest.dispenseRequest.quantity
  Card. = 0..1
  Type = SimpleQuantity
  Short Name = Amount of medication to supply per dispense
  Definition = The amount that is to be dispensed for one fill.
  SCRIPT 10.6 Mapping = Message/Body/NewRx/MedicationPrescribed/DaysSupply
  v2 Mapping = RXD-4-Actual Dispense Amount / RXD-5.1-Actual Dispense Units.code / RXD-5.3-Actual Dispense Units.name of coding system
  RIM Mapping = quantity

 -- Row 29 -----------------------------------
  Element = MedicationRequest.dispenseRequest.expectedSupplyDuration
  Card. = 0..1
  Type = Duration
  Short Name = Number of days supply per dispense
  Definition = Identifies the period time over which the supplied product is expected to be used, or the length of time the dispense is expected to last.
  Comments = In some situations, this attribute may be used instead of quantity to identify the amount supplied by how long it is expected to last, rather than the physical quantity issued, e.g. 90 days supply of medication (based on an ordered dosage). When possible, it is always better to specify quantity, as this tends to be more precise. expectedSupplyDuration will always be an estimate that can be influenced by external factors.
  SCRIPT 10.6 Mapping = Message/Body/NewRx/MedicationPrescribed/Substitutions
  RIM Mapping = expectedUseTime

 -- Row 30 -----------------------------------
  Element = MedicationRequest.dispenseRequest.performer
  Card. = 0..1
  Type = Reference(Organization)
  Short Name = Intended dispenser
  Definition = Indicates the intended dispensing Organization specified by the prescriber.
  RIM Mapping = .outboundRelationship[typeCode=COMP].target[classCode=SPLY, moodCode=RQO] .participation[typeCode=PRF].role[scoper.determinerCode=INSTANCE]
  w5 = who

 -- Row 31 -----------------------------------
  Element = MedicationRequest.substitution
  Card. = 0..1
  UML = -60;400
  Short Name = Any restrictions on medication substitution
  Definition = Indicates whether or not substitution can or should be part of the dispense. In some cases substitution must happen, in other cases substitution must not happen. This block explains the prescriber\'s intent. If nothing is specified substitution may be done.
  SCRIPT 10.6 Mapping = specific values within Message/Body/NewRx/MedicationPrescribed/Substitutions
  RIM Mapping = subjectOf.substitutionPersmission

 -- Row 32 -----------------------------------
  Element = MedicationRequest.substitution.allowed
  Card. = 1..1
  Is Modifier = Y
  Type = boolean
  Short Name = Whether substitution is allowed or not
  Definition = True if the prescriber allows a different drug to be dispensed from what was prescribed.
  Comments = This element is labeled as a modifer because whether substitution is allow or not cannot be ignored.
  SCRIPT 10.6 Mapping = specific values within Message/Body/NewRx/MedicationPrescribed/Substitutions
  v2 Mapping = RXO-9-Allow Substitutions / RXE-9-Substitution Status
  RIM Mapping = code

 -- Row 33 -----------------------------------
  Element = MedicationRequest.substitution.reason
  Card. = 0..1
  Type = CodeableConcept
  Binding = MedicationIntendedSubstitutionReason
  Short Name = Why should (not) substitution be made
  Definition = Indicates the reason for the substitution, or why substitution must or must not be performed.
  SCRIPT 10.6 Mapping = not mapped
  v2 Mapping = RXE-9 Substition status
  RIM Mapping = reasonCode

 -- Row 34 -----------------------------------
  Element = MedicationRequest.priorPrescription
  Card. = 0..1
  Type = Reference(MedicationRequest)
  Short Name = An order/prescription that is being replaced
  Definition = A link to a resource representing an earlier order related order or prescription.
  Workflow Mapping = Request.replaces
  SCRIPT 10.6 Mapping = not mapped
  RIM Mapping = .outboundRelationship[typeCode=?RPLC or ?SUCC]/target[classCode=SBADM,moodCode=RQO]

 -- Row 35 -----------------------------------
  Element = MedicationRequest.detectedIssue
  Card. = 0..*
  Aliases = Contraindication; Drug Utilization Review (DUR); Alert
  Type = Reference (DetectedIssue)
  Short Name = Clinical Issue with action
  Definition = Indicates an actual or potential clinical issue with or between one or more active or proposed clinical actions for a patient; e.g. Drug-drug interaction, duplicate therapy, dosage alert etc.
  Comments = This element can include a detected issue that has been identified either by a decision support system or by a clinician and may include information on the steps that were taken to address the issue.
  RIM Mapping = .inboundRelationship[typeCode=SUBJ]/source[classCode=ALRT,moodCode=EVN].value

 -- Row 36 -----------------------------------
  Element = MedicationRequest.eventHistory
  Card. = 0..*
  Type = Reference(Provenance)
  Short Name = A list of events of interest in the lifecycle
  Definition = Links to Provenance records for past versions of this resource or fulfilling request or event resources that identify key state transitions or updates that are likely to be relevant to a user looking at the current version of the resource.
  Comments = This may not include provenances for all versions of the request – only those deemed “relevant” or important. This SHALL NOT include the Provenance associated with this current version of the resource. (If that provenance is deemed to be a “relevant” change, it will need to be added as part of a later update. Until then, it can be queried directly as the Provenance that points to this version using _revinclude All Provenances should have some historical version of this Request as their subject.)
  Workflow Mapping = Request.relevantHistory
  RIM Mapping = .inboundRelationship(typeCode=SUBJ].source[classCode=CACT, moodCode=EVN]

=== Sheet Search =====================================

 -- Row 1 -----------------------------------
  Name = authoredon
  Type = date
  Description = Return prescriptions written on this date
  Path = MedicationRequest.authoredOn

 -- Row 2 -----------------------------------
  Name = context
  Type = reference
  Description = Return prescriptions with this encounter or episode of care identifier
  Path = MedicationRequest.context

 -- Row 3 -----------------------------------
  Name = identifier
  Type = token
  Description = Return prescriptions with this external identifier
  Path = MedicationRequest.identifier

 -- Row 4 -----------------------------------
  Name = medication
  Type = reference
  Description = Return prescriptions of this medication reference
  Path = MedicationRequest.medicationReference

 -- Row 5 -----------------------------------
  Name = code
  Type = token
  Description = Return prescriptions of this medication code
  Path = MedicationRequest.medicationCodeableConcept

 -- Row 6 -----------------------------------
  Name = subject
  Type = reference
  Description = The identity of a patient to list orders  for
  Path = MedicationRequest.subject

 -- Row 7 -----------------------------------
  Name = status
  Type = token
  Description = Status of the prescription
  Path = MedicationRequest.status

 -- Row 8 -----------------------------------
  Name = requester
  Type = reference
  Description = Returns prescriptions prescribed by this prescriber
  Path = MedicationRequest.requester

 -- Row 9 -----------------------------------
  Name = intended-dispenser
  Type = reference
  Description = Returns prescriptions intended to be dispensed by this Organization
  Path = MedicationRequest.dispenseRequest.performer

 -- Row 10 -----------------------------------
  Name = category
  Type = token
  Description = Returns prescriptions with different categories
  Path = MedicationRequest.category

 -- Row 11 -----------------------------------
  Name = priority
  Type = token
  Description = Returns prescriptions with different priorities
  Path = MedicationRequest.priority

 -- Row 12 -----------------------------------
  Name = intent
  Type = token
  Description = Returns prescriptions with different intents
  Path = MedicationRequest.intent

 -- Row 13 -----------------------------------
  Name = patient
  Type = reference
  Description = Returns prescriptions for a specific patient
  Path = MedicationRequest.subject
  Target Types = Patient

 -- Row 14 -----------------------------------
  Name = date
  Type = date
  Description = Returns medication request to be administered on a specific date
  Path = MedicationRequest.dosageInstruction.timing.event

 -- Row 15 -----------------------------------
  Name = intended-performer
  Type = reference
  Description = Returns the intended performer of the administration of the medication request
  Path = MedicationRequest.performer

 -- Row 16 -----------------------------------
  Name = intended-performertype
  Type = token
  Description = Returns requests for a specific type of performer
  Path = MedicationRequest.performerType

=== Sheet Profiles =====================================

 -- Row 1 -----------------------------------
  Name = medicationrequest-extensions
  IG Name = core
  Filename = medicationrequest-extensions.xml
  Type = spreadsheet

=== Sheet Examples =====================================

 -- Row 1 -----------------------------------
  Name = Text Dose
  Identity = medrx002
  Description = Order for a medication that includes the dosage of a prescription in text
  Filename = medicationrequestexample2.xml

 -- Row 2 -----------------------------------
  Name = Multiple dosage lines
  Identity = medrx0302
  Description = Active Order with link to encounter, reasonCode, note multiple dosage lines, dispenseRequest and substitution - Azithromycin
  Filename = medicationrequest0302.xml

 -- Row 3 -----------------------------------
  Name = PRN dose
  Identity = medrx0301
  Description = Order with as needed (PRN) dosage with pre-condition - Oxycodone - active with reasonCode, note, dispenseRequest and substitution
  Filename = medicationrequest0301.xml

 -- Row 4 -----------------------------------
  Name = Tapering dose
  Identity = medrx0303
  Description = Order for Tapering Dose - Prednisone - active with note and multiple DosageInstructions with boundsPeriod
  Filename = medicationrequest0303.xml

 -- Row 5 -----------------------------------
  Name = Oral Drops
  Identity = medrx0304
  Description = Order for Oral Drops - Nystatin Suspension - completed - with Dispense Request
  Filename = medicationrequest0304.xml

 -- Row 6 -----------------------------------
  Name = Pre Condition
  Identity = medrx0305
  Description = Order with Dosage with a Pre-Condition - Alprazolam - dosageInstructions includes boundsPeriod with periodMax and asNeededCodeableConcept
  Filename = medicationrequest0305.xml

 -- Row 7 -----------------------------------
  Name = Oral Chemo
  Identity = medrx0306
  Description = Oral Chemotherapy Order - Myleran - completed - with reasonCode
  Filename = medicationrequest0306.xml

 -- Row 8 -----------------------------------
  Name = PRN dose
  Identity = medrx0307
  Description = Order with as needed (PRN) dosage - Percocet - completed with link to encounter, dispenseRequest and substitution
  Filename = medicationrequest0307.xml

 -- Row 9 -----------------------------------
  Name = PRN dose
  Identity = medrx0308
  Description = Order for as needed (PRN) dosage - Vicodin - completed with dosageInstruction with additionalInstruction (coded) and as needed with reason, dispenseRequest and substitution
  Filename = medicationrequest0308.xml

 -- Row 10 -----------------------------------
  Name = Oral Chemo
  Identity = medrx0309
  Description = Oral Chemotherapy Order - Capecitabine - active medication with dosing by Body Surface Area (BSA) (mg/m2)
  Filename = medicationrequest0309.xml

 -- Row 11 -----------------------------------
  Name = OTC
  Identity = medrx0310
  Description = Order for Over the Counter Medication - Tylenol PM - with dosage range as needed with pre-condition for use
  Filename = medicationrequest0310.xml

 -- Row 12 -----------------------------------
  Name = Fully populated
  Identity = medrx0311
  Description = Fully populated example of a MedicationRequest - Chlorthalidone - active - with link to encounter, reasonReference, note, dispenseRequest, substitution and eventHistory
  Filename = medicationrequestexample1.xml

 -- Row 13 -----------------------------------
  Name = Liquid
  Identity = medrx0312
  Description = Liquid Medication - Phenytoin with link to prior prescription
  Filename = medicationrequest0312.xml

 -- Row 14 -----------------------------------
  Name = Single Dosage line
  Identity = medrx0313
  Description = Order with a single dosage line - Azithromycin - completed - with link to prior prescription and reason code
  Filename = medicationrequest0313.xml

 -- Row 15 -----------------------------------
  Name = Multiple dosage lines
  Identity = medrx0314
  Description = Order - Levothyroxine - completed with reasonCode, dosageInstructions and dispenseRequest
  Filename = medicationrequest0314.xml

 -- Row 16 -----------------------------------
  Name = Injectable
  Identity = medrx0315
  Description = Order for an injectable medication - Lorazepam - active - with link to encounter, reasonCode and dosageInstruction
  Filename = medicationrequest0315.xml

 -- Row 17 -----------------------------------
  Name = Fully populated
  Identity = medrx0316
  Description = Order for Intravenous Chemotherapy (inpatient order) - Brentuximab Vedotin - completed
  Filename = medicationrequest0316.xml

 -- Row 18 -----------------------------------
  Name = IV Chemo
  Identity = medrx0317
  Description = Order for Intravenous Chemotherapy (inpatient order) - Alemtuzumab - completed with multiple dosageInstruction lines
  Filename = medicationrequest0317.xml

 -- Row 19 -----------------------------------
  Name = IV Antibiotic
  Identity = medrx0318
  Description = Order for Intravenous Antibiotic - Vancomycin - active - with link to encounter, reasonCode, and note
  Filename = medicationrequest0318.xml

 -- Row 20 -----------------------------------
  Name = IV with rate
  Identity = medrx0319
  Description = Order for Intravenous Antibiotic with a Dosage Rate - Piperacillin - completed with reason code
  Filename = medicationrequest0319.xml

 -- Row 21 -----------------------------------
  Name = SC Injection
  Identity = medrx0320
  Description = Order for Subcutaneous injection - Insulin - Lantus - completed, with reason code and dispense request
  Filename = medicationrequest0320.xml

 -- Row 22 -----------------------------------
  Name = SC Injection
  Identity = medrx0321
  Description = Order for Subcutaneous injection with multiple dosage lines - Insulin - Novolog - active - includes reasonCode and note.  Dosage includes additionalInstructions as text
  Filename = medicationrequest0321.xml

 -- Row 23 -----------------------------------
  Name = IV admixture
  Identity = medrx0322
  Description = Order for Intravenous Admixture - Potassium Chloride in D5W - completed with reason code
  Filename = medicationrequest0322.xml

 -- Row 24 -----------------------------------
  Name = TPN
  Identity = medrx0323
  Description = Order for TPN Solution - completed
  Filename = medicationrequest0323.xml

 -- Row 25 -----------------------------------
  Name = Suppository
  Identity = medrx0324
  Description = Order using Medication Code for Rectal Suppository - Acetaminophen - completed with reasonCode, dispenseRequest and substitution
  Filename = medicationrequest0324.xml

 -- Row 26 -----------------------------------
  Name = Topical
  Identity = medrx0325
  Description = Order using Medication Code for Topical Ointment - Nystatin - on hold and with dispense request
  Filename = medicationrequest0325.xml

 -- Row 27 -----------------------------------
  Name = Inhaler
  Identity = medrx0326
  Description = Order using Medication Code for Inhaler - Proventil - on hold with dispenseRequest and substitution
  Filename = medicationrequest0326.xml

 -- Row 28 -----------------------------------
  Name = Patch
  Identity = medrx0327
  Description = Order using Medication Code for Patch - Fentanyl - active, with dispense request
  Filename = medicationrequest0327.xml

 -- Row 29 -----------------------------------
  Name = Spray
  Identity = medrx0328
  Description = Order referencing Medication Resource for Nasal Spray - Nasonex
  Filename = medicationrequest0328.xml

 -- Row 30 -----------------------------------
  Name = Compound
  Identity = medrx0329
  Description = Order referencing Medication Resource for Compounded Product - HC 1%, Salicylic Acid 5% in Glaxal Base - on hold with dispenseRequest
  Filename = medicationrequest0329.xml

 -- Row 31 -----------------------------------
  Name = Eye Drop
  Identity = medrx0330
  Description = Order referencing Medication Resource for Eye Drops - Timoptic - active - with link to encounter, dispenseRequest and substitution flag
  Filename = medicationrequest0330.xml

 -- Row 32 -----------------------------------
  Name = Warfarin
  Identity = medrx0331
  Description = Order for a Dosage that needs to be dispensed as different strength tablets - Warfarin - active
  Filename = medicationrequest0331.xml

 -- Row 33 -----------------------------------
  Name = One time dose
  Identity = medrx0332
  Description = Order for a medication that is intended to be given as a single, once only dose
  Filename = medicationrequest0332.xml

 -- Row 34 -----------------------------------
  Name = Morning
  Identity = medrx0333
  Description = Order for a medication that is intended to be given in the morning
  Filename = medicationrequest0333.xml

 -- Row 35 -----------------------------------
  Name = Monday
  Identity = medrx0334
  Description = Order for a medication that is intended to be given on a specific day
  Filename = medicationrequest0334.xml

 -- Row 36 -----------------------------------
  Name = Time
  Identity = medrx0335
  Description = Order for a medication that is intended to be given at a specific time
  Filename = medicationrequest0335.xml

=== Sheet Examples =====================================
