
=== Sheet Bindings =====================================

 -- Row 1 -----------------------------------
  Binding Name = PerforationStatus
  Binding = value set
  Reference = valueset-nehta-present-absent-ns
  Definition = A code that indicates whether perforation is present

 -- Row 2 -----------------------------------
  Binding Name = NatureOfPerforation
  Binding = value set
  Reference = valueset-nehta-perforation-type
  Definition = A code that indicates the type of perforation

 -- Row 3 -----------------------------------
  Binding Name = ClinicalObstructionStatus
  Binding = value set
  Reference = valueset-nehta-present-absent-ns
  Definition = A code that indicates whether a clinical obstruction is present

 -- Row 4 -----------------------------------
  Binding Name = TumourLocation
  Binding = value set
  Reference = valueset-nehta-crc-tumour-location
  Definition = A code that indicates the antomical location of the tumour from a given list

 -- Row 5 -----------------------------------
  Binding Name = TypeOfOperation
  Binding = value set
  Reference = valueset-nehta-crc-operation-type
  Definition = A code that indicates the type of operation

 -- Row 6 -----------------------------------
  Binding Name = AnteriorResectionType
  Binding = value set
  Reference = valueset-nehta-hi-lo-ultralo
  Definition = A code that idicates the type of anterior resection

 -- Row 7 -----------------------------------
  Binding Name = PreoperativeRadiotherapy
  Binding = value set
  Reference = valueset-nehta-yes-no-ns
  Definition = A code that indicates whether pre-operative radiotherapy was used

 -- Row 8 -----------------------------------
  Binding Name = TypeOfCourse
  Binding = value set
  Reference = valueset-nehta-course-type
  Definition = A code that indicates the type of course of pre-operative radiotherapy

 -- Row 9 -----------------------------------
  Binding Name = NewPrimaryCancerOrRecurrence
  Binding = value set
  Reference = valueset-nehta-cancer-primary-or-recurrence
  Definition = A code that indicates whether a new primary cancer or an recurrence

 -- Row 10 -----------------------------------
  Binding Name = TumourSite
  Binding = value set
  Reference = valueset-nehta-crc-tumour-location
  Definition = A code that indicates the site of the tumour

 -- Row 11 -----------------------------------
  Binding Name = TumourPerforation
  Binding = value set
  Reference = valueset-nehta-present-absent
  Definition = A code that indicates the presence or absence of a tumour perforation

 -- Row 12 -----------------------------------
  Binding Name = RelationshipToAnteriorPeritonealReflection
  Binding = value set
  Reference = valueset-nehta-crc-rel-anterior-peritoneal-reflection
  Definition = A code that indicates the site of tumour in relation to the anterior level of the peritoneal reflection

 -- Row 13 -----------------------------------
  Binding Name = IntactnessOfMesorectum
  Binding = value set
  Reference = valueset-nehta-crc-intactness-of-mesorectum
  Definition = A code that indicates the intactness of the mesorectum

 -- Row 14 -----------------------------------
  Binding Name = Peritoneum
  Binding = value set
  Reference = valueset-nehta-crc-peritoneum-invasion
  Definition = A code that indicates the tumour invovlement in the peritoneum

 -- Row 15 -----------------------------------
  Binding Name = LymphNodes
  Binding = value set
  Reference = valueset-nehta-received-notreceived
  Definition = A code that indicates if lymph nodes were received

 -- Row 16 -----------------------------------
  Binding Name = Polyps
  Binding = value set
  Reference = valueset-nehta-present-absent-na
  Definition = A code that indicates the presence or absence of polyp(s)

 -- Row 17 -----------------------------------
  Binding Name = TumourType
  Binding = value set
  Reference = valueset-nehta-crc-tumour-type
  Definition = A code from the WHO Calssification that indicates the tumour type

 -- Row 18 -----------------------------------
  Binding Name = HistologicalGrade
  Binding = value set
  Reference = valueset-nehta-histological-grade
  Definition = A code that indicates the histological grade of the tumour

 -- Row 19 -----------------------------------
  Binding Name = MaxDegreeInvasionBowelWall
  Binding = value set
  Reference = valueset-nehta-crc-deg-inv-bowel-wall
  Definition = A code that indicates the maximum degree of local invasion into or through the bowel wall

 -- Row 20 -----------------------------------
  Binding Name = InvolvementOfTheProximalOrDistalResectionCut-endMargins
  Binding = value set
  Reference = valueset-nehta-crc-involved-notinvolved
  Definition = A code that indicates involvement of the proximal or distal resection (cut-end) margins

 -- Row 21 -----------------------------------
  Binding Name = InvolvedMargin-s
  Binding = value set
  Reference = valueset-nehta-distal-proximal
  Definition = A code that indicates the involvement at the margins

 -- Row 22 -----------------------------------
  Binding Name = NonperitonealisedCircumferentialMargin
  Binding = value set
  Reference = valueset-nehta-involved-notinvolved
  Definition = A code that indicates the status of the nonperitonealised circumferential margin in rectal tumours

 -- Row 23 -----------------------------------
  Binding Name = LymphNodeInvolvement
  Binding = value set
  Reference = valueset-nehta-present-absent-na
  Definition = A code that indicates lymph node involvement

 -- Row 24 -----------------------------------
  Binding Name = IsolatedExtramuralTumourDeposits
  Binding = value set
  Reference = valueset-nehta-present-absent-na
  Definition = A code that indicates the presence or absence of isolated extra-mural tumour deposits.

 -- Row 25 -----------------------------------
  Binding Name = ApicalNodeInvolvement
  Binding = value set
  Reference = valueset-nehta-present-absent-na
  Definition = A code that indicates apical node involvement

 -- Row 26 -----------------------------------
  Binding Name = IntramuralVeinInvasion
  Binding = value set
  Reference = valueset-nehta-intramural-vein-invasion
  Definition = A code that indicates intramural vein invasion

 -- Row 27 -----------------------------------
  Binding Name = ExtramuralVeinInvasion
  Binding = value set
  Reference = valueset-nehta-extramural-vein-invasion
  Definition = A code that indicates extramural vein invasion

 -- Row 28 -----------------------------------
  Binding Name = SmallVesselInvasion
  Binding = value set
  Reference = valueset-nehta-small-vessel-invasion
  Definition = A code that indicates small vessel invasion

 -- Row 29 -----------------------------------
  Binding Name = PerineuralInvasion
  Binding = value set
  Reference = valueset-nehta-perineural-invasion
  Definition = A code that indicates perineural invasion

 -- Row 30 -----------------------------------
  Binding Name = HistologicallyConfirmedDistantMetastases
  Binding = value set
  Reference = valueset-nehta-present-absent
  Definition = A code that indicates the presence or absence of histologically confirmed distant metastases

 -- Row 31 -----------------------------------
  Binding Name = RelevantCoexistentPathologicalAbnormalities
  Binding = value set
  Reference = valueset-nehta-crc-coexist-path-abnormalities
  Definition = A code that indicates the relevant coexistent pathological abnormalities

 -- Row 32 -----------------------------------
  Binding Name = Dysplasia
  Binding = value set
  Reference = valueset-nehta-dysplasia
  Definition = A code that indicates dysplasia if Ulcerative colitis or Crohn\'s disease is selected for relevant coexistent pathological abnormalities

 -- Row 33 -----------------------------------
  Binding Name = ResponseToNeoadjuvantTherapy
  Binding = value set
  Reference = valueset-nehta-response-to-neoadjuvant-therapy
  Definition = A code that indicates the response to neoadjuvant therapy

 -- Row 34 -----------------------------------
  Binding Name = Mlh1
  Binding = value set
  Reference = valueset-nehta-stain-type
  Definition = A code that indicates MLH-1 testing

 -- Row 35 -----------------------------------
  Binding Name = Pms2
  Binding = value set
  Reference = valueset-nehta-stain-type
  Definition = A code that indicates PMS-2 testing

 -- Row 36 -----------------------------------
  Binding Name = Msh2
  Binding = value set
  Reference = valueset-nehta-stain-type
  Definition = A code that indicates MSH-2 testing

 -- Row 37 -----------------------------------
  Binding Name = Msh6
  Binding = value set
  Reference = valueset-nehta-stain-type
  Definition = A code that indicates MSH-6 testing

 -- Row 38 -----------------------------------
  Binding Name = Msi
  Binding = value set
  Reference = valueset-nehta-msi-options
  Definition = A code that indicates Microsatellite instability (MSI)

 -- Row 39 -----------------------------------
  Binding Name = Braf
  Binding = value set
  Reference = valueset-nehta-mutated-wildtype
  Definition = A code that indicates the BRAF (V600E mutation)

 -- Row 40 -----------------------------------
  Binding Name = Kras
  Binding = value set
  Reference = valueset-nehta-mutated-wildtype
  Definition = A code that indicates the KRAS gene mutation (codons 12 and 13)

 -- Row 41 -----------------------------------
  Binding Name = TumourStageT
  Binding = value set
  Reference = valueset-nehta-crc-tumour-stage-t
  Definition = A code that records tumour stage T

 -- Row 42 -----------------------------------
  Binding Name = TumourStageN
  Binding = value set
  Reference = valueset-nehta-crc-tumour-stage-n
  Definition = A code that records tumour stage N

 -- Row 43 -----------------------------------
  Binding Name = TumourStageM
  Binding = value set
  Reference = valueset-nehta-crc-tumour-stage-m
  Definition = A code that records tumour stage M

 -- Row 44 -----------------------------------
  Binding Name = TumourStageGrouping
  Binding = value set
  Reference = valueset-nehta-crc-tumour-stage-grouping
  Definition = A code that records tumour stage grouping

 -- Row 45 -----------------------------------
  Binding Name = ResidualTumourStatus
  Binding = value set
  Reference = valueset-nehta-residual-tumour-status
  Definition = An R code that records the residual tumour status

 -- Row 46 -----------------------------------
  Binding Name = NewPrimaryOrRecurrence
  Binding = value set
  Reference = valueset-nehta-new-cancer-or-recurrence
  Definition = A code that records whether a new primary cancer or a recurrence

=== Sheet Invariants =====================================

 -- Row 1 -----------------------------------
  Id = 01
  Context = Colorectal.preAnalytic
  English = If there is a perforation, the perforation type must be indicated.
  XPath = not(f:perforation/@value = \'present\') or exists(f:natureOfPerforation)
  Severity = error

 -- Row 2 -----------------------------------
  Id = 02
  Context = Colorectal.preAnalytic.tumourLocation
  English = If the tumour location is rectum, then the distance from the anal verge must be recorded.
  XPath = not(@value = \'Rectum\') or exists(f:distanceAnalVerge)
  Severity = error

 -- Row 3 -----------------------------------
  Id = 03
  Context = Colorectal.preAnalytic.typeOfOperation
  English = If other procedure(s) is selected, then record the type of procedure.
  XPath = not(@value = \'Other procedure(s)\') or exists(f:typeOfProcedure)
  Severity = error

 -- Row 4 -----------------------------------
  Id = 04
  Context = Colorectal.preAnalytic.typeOfOperation
  English = If anterior resection is selected, record anterior resection type.
  XPath = not(@value = \'Anterior resection\') or exists(f:anteriorResectionType)
  Severity = error

 -- Row 5 -----------------------------------
  Id = 05
  Context = Colorectal.preAnalytic.preoperativeRadiotherapy
  English = If pre-operative radiotherapy is done, then the type of course is to be recorded.
  XPath = not(@value = \'Yes\') or exists(f:typeOfCourse)
  Severity = error

 -- Row 6 -----------------------------------
  Id = 06
  Context = Colorectal.preAnalytic.newPrimaryOrRecurrence
  English = If regional (local) recurrence or distant metastasis describe.
  XPath = not((@value = \'Regional (local) recurrence\') or (@value = \'Distant metastases\')) or exists(f:describe)
  Severity = error

 -- Row 7 -----------------------------------
  Id = 07
  Context = Colorectal.macro.tumourSite
  English = If tumour site is rectum, the relationship to anterior peritoneal reflection is to be recorded.
  XPath = not(@value = \'Rectum\') or exists(f:relToAntPeritonealReflection)
  Severity = error

 -- Row 8 -----------------------------------
  Id = 08
  Context = Colorectal.macro.tumourSite
  English = If tumour site is rectum, the intactness of mesorectum is to be recorded.
  XPath = not(@value = \'Rectum\') or exists(f:intactnessOfMesorectum)
  Severity = error

 -- Row 9 -----------------------------------
  Id = 09
  Context = Colorectal.macro
  English = If lymph nodes are received, record the number of nodes
  XPath = not(f:lymphNodes/@value = \'Received\') or exists(f:noLymphNodesPerCassette)
  Severity = error

 -- Row 10 -----------------------------------
  Id = 10
  Context = Colorectal.macro.polyps
  English = If polyps are present, provide a polyp summary.
  XPath = not(f@value = \'Present\') or exists(f:polypSummary)
  Severity = error

 -- Row 11 -----------------------------------
  Id = 11
  Context = Colorectal.micro.proximalOrDistalResectionMargins
  English = If the tumour is involved in the proximal or distal resection (‘cut-end’) margins, then record invovled margin(s).
  XPath = not(f@value = \'Involved\') or exists(f:involvedMargins)
  Severity = error

 -- Row 12 -----------------------------------
  Id = 12
  Context = Colorectal.micro.proximalOrDistalResectionMargins
  English = If the tumour is not involved in the proximal or distal resection (‘cut-end’) margins, then record the microscopic clearance.
  XPath = not(@value = \'Not involved\') or exists(f:microClearance)
  Severity = error

 -- Row 13 -----------------------------------
  Id = 13
  Context = Colorectal.macro.tumourSite
  English = If the tumour is a rectal tumour the status of the nonperitonealised circumferential margin (rectal tumours) is to be recorded.
  XPath = not(f:Colorectal.preAnalytic.tumourLocation/@value = \'Rectum\') or exists(f:Colorectal.micro.nonperitonealisedCircumMargin)
  Severity = error

 -- Row 14 -----------------------------------
  Id = 14
  Context = Colorectal.micro.nonperitonealisedCircumMargin
  English = If the tumour is a rectal tumour and the status of the nonperitonealised circumferential margin (rectal tumours) is not involved, then the clearance is to be recorded.
  XPath = not(@value = \'Not involved\') or exists(f:microClearanceRectum)
  Severity = error

 -- Row 15 -----------------------------------
  Id = 15
  Context = Colorectal.macro
  English = If lymph nodes have been received the tumour inolvement in the lymph nodes is to be recorded.
  XPath = not(lymphNodes/@value = \'Received\') or exists(f:.lymphNodeInvolvement)
  Severity = error

 -- Row 16 -----------------------------------
  Id = 16
  Context = Colorectal.micro.lymphNodeInvolvement
  English = If tumour positive lymph nodes are present then record the site(s) and numbers of lymph nodes.
  XPath = not(@value = \'Present\') or exists(f:lymphNodesDetails)
  Severity = error

 -- Row 17 -----------------------------------
  Id = 17
  Context = Colorectal.micro.histoConfDistMetastases
  English = If histologically confirmed distant metastases are present then the sites are to be recorded.
  XPath = not(@value = \'Present\') or exists(f:site)
  Severity = error

 -- Row 18 -----------------------------------
  Id = 18
  Context = Colorectal.micro.relCoexistPathabnorm
  English = If polyps are present as relevant coexistent pathological abnormalities, then polyp details are to be recorded.
  XPath = not(@value = \'Polyps\') or exists(f:polypDetails)
  Severity = error

 -- Row 19 -----------------------------------
  Id = 19
  Context = Colorectal.micro.relCoexistPathabnorm
  English = If Ulcerative colitis is present as relevant coexistent pathological abnormality, then dysplasia is to be recorded.
  XPath = not(@value = \'Ulcerative colitis\') or exists(f:dysplasia)
  Severity = error

 -- Row 20 -----------------------------------
  Id = 20
  Context = Colorectal.micro.relCoexistPathabnorm
  English = If Crohn\'s disease is present as relevant coexistent pathological abnormality, then dysplasia is to be recorded.
  XPath = not(@value = \'Crohns disease\') or exists(f:dysplasia)
  Severity = error

 -- Row 21 -----------------------------------
  Id = 21
  Context = Colorectal.micro.relCoexistPathabnorm
  English = If other abnormalities is selected as relevant coexistent pathological abnormality, then other abnormaily details are to be recorded.
  XPath = not(@value = \'Other\') or exists(f:otherAbnormality)
  Severity = error

 -- Row 22 -----------------------------------
  Id = 22
  Context = Colorectal.ancillaryTests.msi.code
  English = If MSI unstable, record laboratory performing test and report number
  XPath = not(@value = \'Unstable\') or exists(f:LabDetails)
  Severity = error

 -- Row 23 -----------------------------------
  Id = 23
  Context = Colorectal.ancillaryTests.msi.code
  English = If MSI stable, record laboratory performing test and report number
  XPath = not(@value = \'Stable\') or exists(f:LabDetails)
  Severity = error

 -- Row 24 -----------------------------------
  Id = 24
  Context = Colorectal.ancillaryTests.braf.code
  English = If BRAF mutated, record laboratory performing test and report number
  XPath = not(@value = \'Mutated\') or exists(f:LabDetails)
  Severity = error

 -- Row 25 -----------------------------------
  Id = 25
  Context = Colorectal.ancillaryTests.braf.code
  English = If BRAF wild type, record laboratory performing test and report number
  XPath = not(@value = \'Wild type\') or exists(f:LabDetails)
  Severity = error

 -- Row 26 -----------------------------------
  Id = 26
  Context = Colorectal.ancillaryTests.kras.code
  English = If KRAS mutated, record laboratory performing test and report number
  XPath = not(@value = \'Mutated\') or exists(f:LabDetails)
  Severity = error

 -- Row 27 -----------------------------------
  Id = 27
  Context = Colorectal.ancillaryTests.kras.code
  English = If KRAS wild type, record laboratory performing test and report number
  XPath = not(@value = \'Wild type\') or exists(f:LabDetails)
  Severity = error

=== Sheet Data Elements =====================================

 -- Row 1 -----------------------------------
  Element = Colorectal
  Type = Logical
  Short Label = Colorectal
  Definition = Colorectal cancer
  Logical Mapping = dr := DiagnosticReport
  CAP Code = 28282.1000043

 -- Row 2 -----------------------------------
  Element = Colorectal.subject
  Card. = 1..1
  Aliases = Patient
  Summary = Y
  Type = Reference(Patient|Group)
  Short Label = The subject of the report, usually, but not always, the patient
  Definition = The subject of the report. Usually, but not always, this is a patient. However diagnostic services also perform analyses on specimens collected from a variety of other sources.
  Logical Mapping = dr.subject
  v2 Mapping = PID-3-Patient ID List (no V2 mapping for Group or Device)
  RIM Mapping = participation[typeCode=SBJ]
  Snomed Code = 116154003

 -- Row 3 -----------------------------------
  Element = Colorectal.requester
  Card. = 0..1
  Summary = Y
  Type = Reference(Practitioner)
  Short Label = Who ordered the test
  Definition = The practitioner that holds legal responsibility for ordering the investigation
  Logical Mapping = !req := dr.request->DiagnosticOrder; req[orderer := $value]
  RIM Mapping = participation[typeCode=AUT].role
  LOINC Code = 22027-7
  Snomed Code = 223366009
  To Do = Need to made cardinality [1..1] as the build initially gets errors with this setting.

 -- Row 4 -----------------------------------
  Element = Colorectal.performer
  Card. = 0..1
  Aliases = Laboratory, Service, Practitioner, Department, Company
  Summary = Y
  Type = Reference(Practitioner|Organization)
  Short Label = Responsible Diagnostic Service
  Definition = The diagnostic service that is responsible for issuing the report
  Requirements = Need to know whom to contact if there are queries about the results. Also may need to track the source of reports for secondary data analysis
  Comments = This is not necessarily the source of the atomic data items - it is the entity that takes responsibility for the clinical report.
  Logical Mapping = dr[performer := $value]
  v2 Mapping = PRT-8-Participation Organization (where this PRT-4-Participation = \"PO\")
  RIM Mapping = participation[typeCode=AUT].role[classCode=ASSIGN].scoper
  Snomed Code = 420158005
  To Do = Need to made cardinality [1..1] as the build initially gets errors with this setting.

 -- Row 5 -----------------------------------
  Element = Colorectal.preAnalytic
  Card. = 0..1
  Short Label = Pre Analytic
  Definition = Pre Analytic component - information collection prior to specimen receipt at laboratory.
  Comments = This is just a group/section header and is not a result field
  Logical Mapping = req := dr.request->DiagnosticOrder; req[orderer := $value]
  CAP Code = 28592.1000043
  LOINC Code = 70949-3

 -- Row 6 -----------------------------------
  Element = Colorectal.preAnalytic.clinicalInformation
  Card. = 0..1
  Type = string
  Short Label = Clinical information
  Definition = Clinical information provided on request form
  Logical Mapping = req.reason[text := $value]
  CAP Code = 28593.1000043
  LOINC Code = 55752-0

 -- Row 7 -----------------------------------
  Element = Colorectal.preAnalytic.operatingSurgeonDetails
  Card. = 0..1
  Summary = Y
  Type = Reference(Practitioner)
  Short Label = Operating surgeon details
  Definition = The operating surgeon name and contact details
  Logical Mapping = sp := dr.specimen->Specimen; sp.collection[collector := $value]
  LOINC Code = 22027-7
  To Do = Need to made cardinality [1..1] as the build initially gets errors with this setting.  Query if relevant for operating surgeon.

 -- Row 8 -----------------------------------
  Element = Colorectal.preAnalytic.perforation
  Card. = 0..1
  Inv. = 01
  Type = code
  Binding = PerforationStatus
  Short Label = Perforation
  Definition = Presence or absence of a perforation
  Requirements = If present, record the nature of perforation
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28289.1000043
  LOINC Code = LN-RCPA-00059
  Snomed Code = 50257008

 -- Row 9 -----------------------------------
  Element = Colorectal.preAnalytic.natureOfPerforation
  Card. = 0..*
  Type = code
  Binding = NatureOfPerforation
  Short Label = Nature of perforation
  Definition = The type of perforation
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28296.1000043
  LOINC Code = LN-RCPA-00060
  Snomed Code = 36191001
  To Do = Query if need to:\nadd invariant =1 & add the xpath expression to the invariant tab

 -- Row 10 -----------------------------------
  Element = Colorectal.preAnalytic.clinicalObstruction
  Card. = 0..1
  Type = code
  Binding = ClinicalObstructionStatus
  Short Label = Clinical obstruction
  Definition = Whether a clinical obstruction is present or absent.
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28292.1000043
  LOINC Code = LN-RCPA-00061
  Snomed Code = 81060008

 -- Row 11 -----------------------------------
  Element = Colorectal.preAnalytic.tumourLocation
  Card. = 0..*
  Inv. = 02
  Type = code
  Binding = TumourLocation
  Short Label = Tumour location
  Definition = Anatomical location of the tumour from a given list.
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28307.1000043
  LOINC Code = 33725-3
  Snomed Code = 371480007
  To Do = ? - add UNK to codeset

 -- Row 12 -----------------------------------
  Element = Colorectal.preAnalytic.synchronousTumours
  Card. = 0..1
  Type = string
  Short Label = Synchronous tumours - other site
  Definition = For synchronous tumours indicate each other site
  Requirements = Conditional on rectum being selected.\nMeasured in cm for RCPA requirements.
  Comments = Note\n: Synchronous tumours should be reported separately – this serves only to identify the presence of other synchronous tumours for which separate reports will be submitted.
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28346.1000043
  LOINC Code = LN-RCPA-00062
  To Do = ? If there needs to be an invariant due to this being conditional on Rectum being selected as site.

 -- Row 13 -----------------------------------
  Element = Colorectal.preAnalytic.distanceAnalVerge
  Card. = 0..1
  Type = SimpleQuantity
  Short Label = Distance from anal verge
  Definition = Quantitative measurement of distance from anal verge
  Requirements = Conditional on rectum being selected.\nMeasured in cm for RCPA requirements.
  Comments = Conditional on rectum being selected\nNote : Measured in cm by longstanding surgical convention
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28335.1000043
  LOINC Code = 33748-5
  Snomed Code = 371490004

 -- Row 14 -----------------------------------
  Element = Colorectal.preAnalytic.typeOfOperation
  Card. = 0..1
  Inv. = 03,04
  Type = code
  Binding = TypeOfOperation
  Short Label = *
  Definition = The type of operation selected from a list
  Requirements = Single selection value list.\nIf other procedure(s) is selected, record type of procedure.\nIf anterior resection is selected, record anterior resection type.
  Logical Mapping = too := req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 27919.1000043
  LOINC Code = 29306-8
  Snomed Code = 387713003
  To Do = ? - add UNK to codeset

 -- Row 15 -----------------------------------
  Element = Colorectal.preAnalytic.typeOfProcedure
  Card. = 0..1
  Type = string
  Short Label = Procedure type
  Definition = Type of procedure
  Logical Mapping = too.text

 -- Row 16 -----------------------------------
  Element = Colorectal.preAnalytic.anteriorResectionType
  Card. = 0..1
  Type = code
  Binding = AnteriorResectionType
  Short Label = Anterior resection type
  Definition = The type of anterior resection
  Requirements = Single selection value list.
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28278.1000043
  To Do = Check with RCPA about Definition\n? - add UNK to codeset

 -- Row 17 -----------------------------------
  Element = Colorectal.preAnalytic.preoperativeRadiotherapy
  Card. = 0..1
  Inv. = 05
  Type = code
  Binding = PreoperativeRadiotherapy
  Short Label = Pre-operative radiotherapy
  Definition = An indication of pre-operative radiotherapy
  Requirements = Single selection value list.\nIf yes, record type of course
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28283.1000043
  LOINC Code = LN-RCPA-00063
  Snomed Code = 168523002
  To Do = ? add an invariant to accommodate the conditional statement \"if Yes …\"

 -- Row 18 -----------------------------------
  Element = Colorectal.preAnalytic.typeOfCourse
  Card. = 0..1
  Type = code
  Binding = TypeOfCourse
  Short Label = Type of course
  Definition = The type of course of pre-operative radiotherapy
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28286.100004299999

 -- Row 19 -----------------------------------
  Element = Colorectal.preAnalytic.surgeonsOpinion
  Card. = 0..1
  Type = string
  Short Label = Surgeons opinion of residual cancer
  Definition = Surgeons opinion on the existence of local residual cancer postsurgery
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28295.1000043
  LOINC Code = 81169-5
  To Do = FYI - short label & definition did not like apostrophe s ie surgeon\'s

 -- Row 20 -----------------------------------
  Element = Colorectal.preAnalytic.adjacentOrgans
  Card. = 0..1
  Type = string
  Short Label = Adjacent organ involvement
  Definition = Involvement of adjacent organs
  Logical Mapping = req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28336.1000043
  LOINC Code = LN-RCPA-00064

 -- Row 21 -----------------------------------
  Element = Colorectal.preAnalytic.newPrimaryOrRecurrence
  Card. = 0..1
  Inv. = 06
  Type = code
  Binding = NewPrimaryCancerOrRecurrence
  Short Label = New primary cancer or recurrence
  Definition = An indication of whether a new primary cancer or a recurrence
  Requirements = Single selection value list.\nIf regional (local) recurrence or distant metastasis describe.
  Comments = ? If need to make an invariant due to the conditional statement
  Logical Mapping = pno := req.supportingInformation -> Observation[code := %map-codes; value[x] := $value]
  CAP Code = 28337.1000043
  LOINC Code = 21983-2

 -- Row 22 -----------------------------------
  Element = Colorectal.preAnalytic.RecurrenceDescription
  Card. = 0..1
  Type = string
  Short Label = Describe
  Definition = Description of regional (local) recurrence or distant metastases
  Logical Mapping = pno.component[code := %map-codes; value[x] := $value]
  LOINC Code = LN-RCPA-00065

 -- Row 23 -----------------------------------
  Element = Colorectal.preAnalytic.pathologyAccessionNumber
  Card. = 0..1
  Type = string
  Short Label = Pathology number
  Definition = Pathology accession number
  Logical Mapping = dr[identifier := $value]
  CAP Code = 28300.1000043
  LOINC Code = 57723-9

 -- Row 24 -----------------------------------
  Element = Colorectal.preAnalytic.otherRelevantDetails
  Card. = 0..1
  Type = string
  Short Label = Other details
  Definition = Other relevant details
  Logical Mapping = req.note[text := $value]
  CAP Code = 28301.1000043
  LOINC Code = 55752-0

 -- Row 25 -----------------------------------
  Element = Colorectal.macro
  Card. = 0..1
  Short Label = Macroscopy
  Definition = Macroscopic findings
  Comments = This is just a group/section header and is not a result field
  Logical Mapping = macro := dr.result->Observation[code := %map-codes]
  CAP Code = 27906.1000043
  LOINC Code = 70949-3
  Snomed Code = 250429001

 -- Row 26 -----------------------------------
  Element = Colorectal.macro.specimenLength
  Card. = 1..1
  Type = SimpleQuantity
  Short Label = Specimen length
  Definition = The length of the specimen
  Requirements = measurement in mm.
  Comments = Query if measurements are in mm is international ie USA and query if this comment needs to be refined to AUS?\nDitto for subsequent metric measurements.
  Logical Mapping = sp1 := dr.specimen->Specimen; sp1.collection[quantity := $value]
  CAP Code = 28342.1000043
  LOINC Code = LN-RCPA-00066
  Snomed Code = 384606002

 -- Row 27 -----------------------------------
  Element = Colorectal.macro.tumourSite
  Card. = 1..1
  Inv. = 07,08,13
  Type = code
  Binding = TumourSite
  Short Label = Tumour site
  Definition = The site of the tumour
  Logical Mapping = sp2 := dr.specimen->Specimen; sp2.collection[bodySite := $value]
  CAP Code = 27931.1000043
  LOINC Code = 33725-3
  Snomed Code = 371480007

 -- Row 28 -----------------------------------
  Element = Colorectal.macro.maxTumourDiameter
  Card. = 1..1
  Type = SimpleQuantity
  Short Label = Max. tumour diameter
  Definition = Maximum tumour diameter
  Requirements = measurement in mm.
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28360.1000043
  LOINC Code = 21889-1

 -- Row 29 -----------------------------------
  Element = Colorectal.macro.distanceNearerProxOrDistal
  Card. = 1..*
  Type = SimpleQuantity
  Short Label = Dist. of tumour to the nearer proximal or distal \"cut end\"
  Definition = Distance of tumour to the nearer proximal or distal \"cut end\"
  Requirements = measurement in mm.
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28359.1000043
  LOINC Code = 81175-2

 -- Row 30 -----------------------------------
  Element = Colorectal.macro.distNonperitonCircumMargin
  Card. = 1..1
  Type = SimpleQuantity
  Short Label = Dist. of tumour to the nonperitonealised circumferential margin
  Definition = Distance of tumour to the nonperitonealised circumferential margin
  Requirements = measurement in mm.
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28358.1000043
  LOINC Code = LN-RCPA-00067

 -- Row 31 -----------------------------------
  Element = Colorectal.macro.tumourPerforation
  Card. = 1..1
  Type = code
  Binding = TumourPerforation
  Short Label = Tumour perforation
  Definition = The presence or absence of tumour perforation
  Requirements = Single selection value list.
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 27963.1000043
  LOINC Code = LN-RCPA-00068

 -- Row 32 -----------------------------------
  Element = Colorectal.macro.relToAntPeritonealReflection
  Card. = 0..1
  Type = code
  Binding = RelationshipToAnteriorPeritonealReflection
  Short Label = Relationship to anterior peritoneal reflection
  Definition = Site of tumour in relation to the anterior level of the peritoneal reflection
  Requirements = Single selection value list.\nConditional on rectum being selected in Tumour Site
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28362.1000043
  LOINC Code = LN-RCPA-00069
  To Do = ? Make an invariant on rectum in tumour site

 -- Row 33 -----------------------------------
  Element = Colorectal.macro.intactnessOfMesorectum
  Card. = 0..1
  Type = code
  Binding = IntactnessOfMesorectum
  Short Label = Intactness of mesorectum
  Definition = For rectal resections the intactness of the mesorectum must be recorded.
  Requirements = Single selection value list.\nConditional on rectum being selected in Tumour Site
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 27967.1000043
  LOINC Code = 33730-3
  Snomed Code = 408655002
  To Do = ? Make an invariant on rectum in tumour site

 -- Row 34 -----------------------------------
  Element = Colorectal.macro.peritoneum
  Card. = 0..1
  Type = code
  Binding = Peritoneum
  Short Label = Peritoneum
  Definition = Any involvement of the peritoneum should be recorded.
  Requirements = Single selection value list.
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28369.1000043
  LOINC Code = 66111-6

 -- Row 35 -----------------------------------
  Element = Colorectal.macro.lymphNodes
  Card. = 0..1
  Inv. = 09,15
  Type = code
  Binding = LymphNodes
  Short Label = Lymph nodes
  Definition = If lymph nodes are received, then they should be recorded.
  Requirements = Conditional:\nIf received, record the number of nodes
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28372.1000043
  LOINC Code = 66112-4
  Snomed Code = 364108009

 -- Row 36 -----------------------------------
  Element = Colorectal.macro.noLymphNodesPerCassette
  Card. = 0..*
  Type = string
  Short Label = Number of lymph nodes in each cassette
  Definition = The number of lymph nodes placed in each cassette should be recorded.
  Comments = The RCPA require the following be recorded:\n\"Numeric: ___ in cassette: ___\"\nQuery how to record this?
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28387.1000043
  LOINC Code = 44621-1
  Snomed Code = 444025001

 -- Row 37 -----------------------------------
  Element = Colorectal.macro.polyps
  Card. = 0..1
  Inv. = 10
  Type = code
  Binding = Polyps
  Short Label = Polyps
  Definition = The presence or absence of polyps should be recorded
  Requirements = Conditional:\nIf present, provide a polyp summary.
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28376.1000043
  LOINC Code = LN-RCPA-00070
  Snomed Code = 41329004

 -- Row 38 -----------------------------------
  Element = Colorectal.macro.polypSummary
  Card. = 0..1
  Type = string
  Short Label = The number, diameter and gross configuration of polyps should be summarised
  Definition = The polyp summary should include the numbers, diameter range and gross appearance
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28379.1000043
  LOINC Code = 33745-1

 -- Row 39 -----------------------------------
  Element = Colorectal.macro.otherMacroComments
  Card. = 0..1
  Type = string
  Short Label = Other macroscopic comments
  Definition = A descriptive or narrative field should be provided to record any macroscopic information that is not recorded in the above standards and guidelines, and that would normally form part of the macroscopic description.
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28380.1000043
  LOINC Code = 22634-0
  Snomed Code = 395526000

 -- Row 40 -----------------------------------
  Element = Colorectal.macro.natureAndSiteOfBlocks
  Card. = 1..*
  Type = string
  Short Label = Nature and site of blocks
  Definition = The nature and sites of all blocks must be recorded.
  Logical Mapping = macro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28381.100004299999
  LOINC Code = 81178-6

 -- Row 41 -----------------------------------
  Element = Colorectal.micro
  Card. = 0..1
  Short Label = Microscopy
  Definition = Microscopy of the sample
  Comments = This is just a group/section header and is not a result field
  Logical Mapping = micro := dr.result->Observation[code := %map-codes]
  CAP Code = 27973.1000043
  LOINC Code = 70949-3

 -- Row 42 -----------------------------------
  Element = Colorectal.micro.tumourType
  Card. = 1..1
  Type = code
  Binding = TumourType
  Short Label = Tumour type
  Definition = A single selection value list from WHO Classification of Tumours.
  Requirements = Single selection value list from WHO Classification of Tumours. Pathology and Genetics of Tumours of the Digestive System (2010).
  Comments = How to represent this result group which has heading and components cf the bindings file is a flat file??
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 27974.1000043
  LOINC Code = LN-RCPA-00071
  Snomed Code = 371441004

 -- Row 43 -----------------------------------
  Element = Colorectal.micro.histologicalGrade
  Card. = 1..1
  Type = code
  Binding = HistologicalGrade
  Short Label = Histological grade
  Definition = The histological grading of the tumour must be recorded.
  Requirements = Single selection value list.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 27988.1000043
  LOINC Code = 33732-9
  Snomed Code = 371469007

 -- Row 44 -----------------------------------
  Element = Colorectal.micro.maxDegreeLocalInvasion
  Card. = 1..1
  Type = code
  Binding = MaxDegreeInvasionBowelWall
  Short Label = Maximum degree of local invasion into or through the bowel wall
  Definition = The maximum degree of local invasion into or through the bowel wall must be recorded.
  Requirements = Single selection value list.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28534.1000043
  LOINC Code = LN-RCPA-00072
  Snomed Code = 370052007

 -- Row 45 -----------------------------------
  Element = Colorectal.micro.proximalOrDistalResectionMargins
  Card. = 0..1
  Inv. = 11,12
  Type = code
  Binding = InvolvementOfTheProximalOrDistalResectionCut-endMargins
  Short Label = Involvement of the proximal or distal resection (cut-end) margins
  Definition = Involvement of the proximal or distal resection margins (cut-end margins) by tumour must be recorded. If the margin is less than 10 mm, the clearance must be recorded.
  Requirements = Single selection value list.\nIf involved is selected, record involved margin(s)\nIf not involved is selected, record microscopic clearance.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28348.1000043
  LOINC Code = LN-RCPA-00073

 -- Row 46 -----------------------------------
  Element = Colorectal.micro.involvedMargins
  Card. = 1..*
  Type = code
  Binding = InvolvedMargin-s
  Short Label = Involved margin(s)
  Definition = Involvement of the proximal or distal resection margins (cut-end margins) by tumour must be recorded. If the margin is less than 10 mm, the clearance must be recorded.
  Requirements = Multi select value list (select all that apply).\nThis is a conditional field.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28351.1000043
  LOINC Code = 44699-7
  Snomed Code = 423105004

 -- Row 47 -----------------------------------
  Element = Colorectal.micro.marginsMicroClearance
  Card. = 0..1
  Type = SimpleQuantity
  Short Label = Microscopic Clearance
  Definition = If the margin is less than 10 mm, the clearance must be recorded.
  Requirements = Numeric: ___mm (if the margin is less than 10 mm)\nOR Clearance is ≥10mm
  Comments = Query how to achieve this??
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28396.1000043
  LOINC Code = LN-RCPA-00074

 -- Row 48 -----------------------------------
  Element = Colorectal.micro.nonperitonealisedCircumMargin
  Card. = 0..1
  Inv. = 14
  Type = code
  Binding = NonperitonealisedCircumferentialMargin
  Short Label = Status of the nonperitonealised circumferential margin (rectal tumours)
  Definition = The status of the nonperitonealised circumferential margin in rectal tumours must be recorded.
  Requirements = Single selection value list.\nConditional on rectum being selected in S2.02\nIf not involved is selected, record microscopic clearance.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28354.1000043
  LOINC Code = LN-RCPA-00075

 -- Row 49 -----------------------------------
  Element = Colorectal.micro.microClearanceRectum
  Card. = 0..1
  Type = SimpleQuantity
  Short Label = Microscopic Clearance
  Definition = In rectal tumours, the minimum distance in millimetres between the tumour and the nonperitonealised (circumferential, radial) margin must be recorded from the histological slides.
  Requirements = Is conditional
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28400.1000043
  LOINC Code = LN-RCPA-00076

 -- Row 50 -----------------------------------
  Element = Colorectal.micro.lymphNodeInvolvement
  Card. = 0..1
  Inv. = 16
  Type = code
  Binding = LymphNodeInvolvement
  Short Label = Lymph node involvement
  Definition = Results of lymph node histopathology must be recorded.
  Requirements = Single selection value list.\nConditional on nodes being received in G2.02. If G2.02 has been recorded as “not received” this standard is not required.\nIf present, record site(s) and number of lymph nodes
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28338.1000043
  LOINC Code = 21892-5

 -- Row 51 -----------------------------------
  Element = Colorectal.micro.lymphNodesDetails
  Card. = 0..1
  Short Label = Site(s) and numbers of lymph nodes
  Definition = If lymph node(s) received then the site(s) and numbers of lymph nodes must be recorded.

 -- Row 52 -----------------------------------
  Element = Colorectal.micro.lymphNodesDetails.site
  Card. = 0..*
  Type = string
  Short Label = Site(s) of lymph nodes
  Definition = The site(s) of the lymph nodes must be recorded
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28403.1000043
  LOINC Code = 39111-0

 -- Row 53 -----------------------------------
  Element = Colorectal.micro.lymphNodesDetails.numPos
  Card. = 0..*
  Type = string
  Short Label = Number of positive nodes
  Definition = Number of positive nodes from this site
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28406.100004299999
  LOINC Code = 21893-3

 -- Row 54 -----------------------------------
  Element = Colorectal.micro.lymphNodesDetails.numExamined
  Card. = 0..*
  Type = string
  Short Label = Number of nodes examined
  Definition = Total number of nodes from this site
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28437.100004299999
  LOINC Code = 21894-1

 -- Row 55 -----------------------------------
  Element = Colorectal.micro.extramuralTumourDeposits
  Card. = 0..1
  Type = code
  Binding = IsolatedExtramuralTumourDeposits
  Short Label = Isolated extra-mural tumour deposits
  Definition = The presence or absence of isolated extra-mural tumour deposits is to be recorded.
  Requirements = Single selection value list.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28392.1000043
  LOINC Code = LN-RCPA-00077

 -- Row 56 -----------------------------------
  Element = Colorectal.micro.apicalNodeInvolvement
  Card. = 0..1
  Type = code
  Binding = ApicalNodeInvolvement
  Short Label = Apical node involvement
  Definition = Involvement of the apical lymph node should be recorded.
  Requirements = Single selection value list.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28407.1000043
  LOINC Code = LN-RCPA-00078

 -- Row 57 -----------------------------------
  Element = Colorectal.micro.venousSmallVesselInvasion
  Card. = 0..1
  Type = string
  Short Label = Venous and small vessel invasion
  Definition = For all tumours, venous and small vessel invasion must be reported and its anatomic location specified as intramural or extramural.
  Comments = This is just a header and is not a data field\n?? How to be entered in the resource
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28411.1000043
  LOINC Code = 33761-8
  Snomed Code = 371512006

 -- Row 58 -----------------------------------
  Element = Colorectal.micro.intramuralVeinInvasion
  Card. = 1..1
  Type = code
  Binding = IntramuralVeinInvasion
  Short Label = Intramural vein invasion
  Definition = Intramural invasion must be reported on
  Requirements = Single selection value list.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28412.1000043
  LOINC Code = LN-RCPA-00079

 -- Row 59 -----------------------------------
  Element = Colorectal.micro.extramuralVeinInvasion
  Card. = 1..1
  Type = code
  Binding = ExtramuralVeinInvasion
  Short Label = Extramural vein invasion
  Definition = Extramural invasion must be reported on
  Requirements = Single selection value list.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28415.1000043
  LOINC Code = LN-RCPA-00080

 -- Row 60 -----------------------------------
  Element = Colorectal.micro.smallVesselInvasion
  Card. = 1..1
  Type = code
  Binding = SmallVesselInvasion
  Short Label = Small vessel invasion
  Definition = Small vessel invasion must be reported on
  Requirements = Single selection value list.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28418.1000043
  LOINC Code = 33739-4
  Snomed Code = 372264001

 -- Row 61 -----------------------------------
  Element = Colorectal.micro.perineuralInvasion
  Card. = 1..1
  Type = code
  Binding = PerineuralInvasion
  Short Label = Perineural invasion
  Definition = Perineural invasion must be reported on
  Requirements = Single selection value list.
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28136.1000043
  LOINC Code = 33741-0
  Snomed Code = 371513001

 -- Row 62 -----------------------------------
  Element = Colorectal.micro.histoConfDistMetastases
  Card. = 1..1
  Inv. = 17
  Type = code
  Binding = HistologicallyConfirmedDistantMetastases
  Short Label = Histologically confirmed distant metastases
  Definition = The presence or absence of histologically confirmed distant metastases must be recorded
  Requirements = Single selection value list.\nIf present, record sites
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28236.1000043
  LOINC Code = LN-RCPA-00081
  Snomed Code = 399608002

 -- Row 63 -----------------------------------
  Element = Colorectal.micro.histoConfDistMetastasesSite
  Card. = 0..1
  Type = string
  Short Label = Histologically confirmed distant metastases - site
  Definition = The site of histologically confirmed distant metastases must be recorded
  Requirements = Is conditional
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28242.1000043
  LOINC Code = 21920-4
  Snomed Code = 385421009

 -- Row 64 -----------------------------------
  Element = Colorectal.micro.relCoexistPathabnorm
  Card. = 1..*
  Inv. = 18,19,20,21
  Type = code
  Binding = RelevantCoexistentPathologicalAbnormalities
  Short Label = Relevant coexistent pathological abnormalities
  Definition = The relevant coexistent pathological abnormalities must be recorded
  Requirements = Multi select value list (select all that apply).\n?? How is this indicated??\nIf Polyps is selected provide details\nIf Ulcerative colitis or Crohn’s disease is selected record dysplasia\nIf other is selected, provide details in “other abnormality”
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28244.1000043
  LOINC Code = 81317-0
  Snomed Code = 371498006

 -- Row 65 -----------------------------------
  Element = Colorectal.micro.polypDetails
  Card. = 0..1
  Type = string
  Short Label = Polyp details (type, number, polyposis syndrome criteria met etc)
  Definition = The polyp details (type, number, polyposis syndrome criteria met etc) is to be recorded
  Requirements = Is conditional
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  LOINC Code = 33745-1

 -- Row 66 -----------------------------------
  Element = Colorectal.micro.dysplasia
  Card. = 0..1
  Type = code
  Binding = Dysplasia
  Short Label = Dysplasia
  Definition = If Ulcerative colitis or Crohns disease is selected for relevant coexistent pathological abnormalities record dysplasia
  Requirements = Single selection value list.\nIs conditional
  Comments = Cannot have an apostrophe in a spreadsheet eg Crohn apostrophe s
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]

 -- Row 67 -----------------------------------
  Element = Colorectal.micro.otherAbnormality
  Card. = 0..1
  Type = string
  Short Label = Other abnormality
  Definition = Record any other abnormality
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  LOINC Code = 44624-5

 -- Row 68 -----------------------------------
  Element = Colorectal.micro.microResidualTumourStatus
  Card. = 1..1
  Type = string
  Short Label = Microscopic residual tumour status (completeness of resection)
  Definition = The microscopic residual tumour status (completeness of resection) is to be recorded
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28425.1000043
  LOINC Code = LN-RCPA-00082

 -- Row 69 -----------------------------------
  Element = Colorectal.micro.neoadjuvantTherapy
  Card. = 0..1
  Type = code
  Binding = ResponseToNeoadjuvantTherapy
  Short Label = Response to neoadjuvant therapy
  Definition = The response to neoadjuvant therapy should be recorded
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28123.1000043
  LOINC Code = LN-RCPA-00083

 -- Row 70 -----------------------------------
  Element = Colorectal.micro.microComments
  Card. = 0..1
  Type = string
  Short Label = Microscopic comments
  Definition = Other Microscopic comments should be recorded
  Logical Mapping = micro.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28431.1000043
  LOINC Code = 22635-7
  Snomed Code = 395527009

 -- Row 71 -----------------------------------
  Element = Colorectal.ancillaryTests
  Card. = 0..1
  Type = string
  Short Label = Ancillary test findings
  Definition = Ancillary test findings are to be recorded
  Requirements = Immunohistochemical stains for microsatellite instability will be performed and a supplementary report issued
  Comments = This is just a group/section header and is not a result field, but some example reports this field was used as a comment field.
  Logical Mapping = ancillary := dr.result->Observation[code := %map-codes]
  CAP Code = 28156.1000043
  LOINC Code = 70949-3

 -- Row 72 -----------------------------------
  Element = Colorectal.ancillaryTests.mismatchRepairEnz
  Card. = 1..1
  Short Label = Mismatch repair enzymes
  Definition = Mismatch repair enzymes are to be recorded
  Comments = This is just a sub-group/sub-section header and is not a result field
  CAP Code = 28433.1000043

 -- Row 73 -----------------------------------
  Element = Colorectal.ancillaryTests.mlh1
  Card. = 0..1
  Type = code
  Binding = Mlh1
  Short Label = MLH-1
  Definition = MLH-1 testing
  Requirements = Single selection value list.
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28434.1000043
  LOINC Code = 50322-7

 -- Row 74 -----------------------------------
  Element = Colorectal.ancillaryTests.pms2
  Card. = 0..1
  Type = code
  Binding = Pms2
  Short Label = PMS-2
  Definition = PMS-2 testing
  Requirements = Single selection value list.
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28442.1000043
  LOINC Code = 50328-4

 -- Row 75 -----------------------------------
  Element = Colorectal.ancillaryTests.msh2
  Card. = 0..1
  Type = code
  Binding = Msh2
  Short Label = MSH-2
  Definition = MSH-2 testing
  Requirements = Single selection value list.
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28493.1000043
  LOINC Code = 50323-5

 -- Row 76 -----------------------------------
  Element = Colorectal.ancillaryTests.msh6
  Card. = 0..1
  Type = code
  Binding = Msh6
  Short Label = MSH-6
  Definition = MSH-6 testing
  Requirements = Single selection value list.
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28544.1000043
  LOINC Code = 50324-3

 -- Row 77 -----------------------------------
  Element = Colorectal.ancillaryTests.comments
  Card. = 0..1
  Type = string
  Short Label = Mismatch repair enzyme comments
  Definition = Mismatch repair enzyme comments can be recorded
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28436.1000043
  LOINC Code = 8262-8

 -- Row 78 -----------------------------------
  Element = Colorectal.ancillaryTests.msi
  Card. = 0..1
  Inv. = 22,23
  Short Label = Microsatellite instability (MSI)
  Definition = Microsatellite instability (MSI) to be recorded
  Requirements = Single selection value list.\nIf unstable or stable, record laboratory performing test and report number
  Comments = This is just a group/section header and is not a result field

 -- Row 79 -----------------------------------
  Element = Colorectal.ancillaryTests.msi.code
  Card. = 0..1
  Type = code
  Binding = Msi
  Short Label = Microsatellite instability (MSI)
  Definition = Microsatellite instability (MSI) to be recorded
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28399.1000043
  LOINC Code = 43368-0
  Snomed Code = 443412009

 -- Row 80 -----------------------------------
  Element = Colorectal.ancillaryTests.msi.comments
  Card. = 0..1
  Type = string
  Short Label = Microsatellite instability (MSI) comments
  Definition = Microsatellite instability (MSI) comments can be recorded
  Requirements = Conditional
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28453.1000043
  LOINC Code = 8265-1

 -- Row 81 -----------------------------------
  Element = Colorectal.ancillaryTests.msi.labDetails
  Card. = 0..1
  Type = string
  Short Label = MSI laboratory performing test and report number
  Definition = Microsatellite instability (MSI) laboratory performing test and report number can be recorded
  Requirements = Conditional
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28447.1000043
  LOINC Code = 30954-2

 -- Row 82 -----------------------------------
  Element = Colorectal.ancillaryTests.braf
  Card. = 0..1
  Inv. = 24,25
  Short Label = BRAF (V600E mutation)
  Definition = BRAF (V600E mutation) testing
  Requirements = Single selection value list.\nIf mutated or wild type, record laboratory performing test and report number
  Comments = This is just a group/section header and is not a result field

 -- Row 83 -----------------------------------
  Element = Colorectal.ancillaryTests.braf.code
  Card. = 0..1
  Type = code
  Binding = Braf
  Short Label = BRAF (V600E mutation)
  Definition = BRAF (V600E mutation) testing
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28454.1000043
  LOINC Code = 58483-9

 -- Row 84 -----------------------------------
  Element = Colorectal.ancillaryTests.braf.comments
  Card. = 0..1
  Type = string
  Short Label = BRAF (V600E mutation) comments
  Definition = BRAF (V600E mutation) comments can be recorded
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28460.1000043
  LOINC Code = 8264-4

 -- Row 85 -----------------------------------
  Element = Colorectal.ancillaryTests.braf.labDetails
  Card. = 0..1
  Type = string
  Short Label = BRAF (V600E mutation) laboratory performing test and report number
  Definition = BRAF (V600E mutation) laboratory performing test and report number can be recorded
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28459.1000043
  LOINC Code = 30954-2

 -- Row 86 -----------------------------------
  Element = Colorectal.ancillaryTests.kras
  Card. = 0..1
  Inv. = 26,27
  Short Label = KRAS gene mutation (codons 12 and 13)
  Definition = KRAS gene mutation (codons 12 and 13) testing
  Comments = This is just a group/section header and is not a result field

 -- Row 87 -----------------------------------
  Element = Colorectal.ancillaryTests.kras.code
  Card. = 0..1
  Type = code
  Binding = Kras
  Short Label = KRAS gene mutation (codons 12 and 13)
  Definition = KRAS gene mutation (codons 12 and 13) testing
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28461.1000043
  LOINC Code = 21703-4

 -- Row 88 -----------------------------------
  Element = Colorectal.ancillaryTests.kras.comments
  Card. = 0..1
  Type = string
  Short Label = KRAS gene mutation (codons 12 and 13) comments
  Definition = KRAS gene mutation (codons 12 and 13) comments can be recorded
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28465.1000043
  LOINC Code = 8266-9

 -- Row 89 -----------------------------------
  Element = Colorectal.ancillaryTests.kras.labDetails
  Card. = 0..1
  Type = string
  Short Label = KRAS gene mutation (codons 12 and 13) laboratory performing test and report number
  Definition = KRAS gene mutation (codons 12 and 13) laboratory performing test and report number can be recorded
  Logical Mapping = ancillary.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28466.1000043
  LOINC Code = 30954-2

 -- Row 90 -----------------------------------
  Element = Colorectal.synthesisOverview
  Card. = 0..1
  Short Label = Synthesis and Overview
  Definition = Synthesis and Overview are to be recorded
  Comments = This is just a group/section header and is not a result field
  Logical Mapping = synthesis := dr.result->Observation[code := %map-codes]
  CAP Code = 28253.1000043
  LOINC Code = 70949-3

 -- Row 91 -----------------------------------
  Element = Colorectal.synthesisOverview.tumourStage
  Card. = 1..1
  Type = string
  Short Label = Tumour stage
  Definition = Tumour stage is to be recorded
  Comments = This is just a sub-group/sub-section header and is not a result field
  Logical Mapping = synthesis.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28204.1000043
  LOINC Code = 21902-2
  Snomed Code = 371508000

 -- Row 92 -----------------------------------
  Element = Colorectal.synthesisOverview.tumourStageT
  Card. = 0..1
  Type = code
  Binding = TumourStageT
  Short Label = T
  Definition = Tumour stage T is to be recorded
  Requirements = Single selection value list.
  Logical Mapping = synthesis.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28210.1000043
  LOINC Code = 21899-0
  Snomed Code = 78873005

 -- Row 93 -----------------------------------
  Element = Colorectal.synthesisOverview.tumourStageN
  Card. = 0..1
  Type = code
  Binding = TumourStageN
  Short Label = N
  Definition = Tumour stage N is to be recorded
  Requirements = Single selection value list.
  Logical Mapping = synthesis.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28220.1000043
  LOINC Code = 21900-6
  Snomed Code = 277206009

 -- Row 94 -----------------------------------
  Element = Colorectal.synthesisOverview.tumourStageM
  Card. = 0..1
  Type = code
  Binding = TumourStageM
  Short Label = M
  Definition = Tumour stage M is to be recorded
  Requirements = Single selection value list.
  Logical Mapping = synthesis.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28552.1000043
  LOINC Code = 67211-3
  Snomed Code = 277208005

 -- Row 95 -----------------------------------
  Element = Colorectal.synthesisOverview.tumourStageGrouping
  Card. = 1..1
  Type = code
  Binding = TumourStageGrouping
  Short Label = Stage grouping
  Definition = Tumour stage grouping is to be recorded
  Requirements = Single selection value list.
  Comments = Check the formatting of the result group
  Logical Mapping = synthesis.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28243.1000043
  LOINC Code = 21902-2
  Snomed Code = 399390009
  Committee Notes = 0 Tis N0 M0   |\nI T1 N0 M0   |\nT2 N0 M0   |\nIIA T3 N0 M0   |\nIIB T4a N0 M0   |\nIIC T4b N0 M0   |\nIIIA T1-T2 N1/N1c M0   |\nT1 N2a M0   |\nIIIB T3-T4a N1/N1c M0   |\nT2-T3 N2a M0   |\nT1-T2 N2b M0   |\nIIIC T4a N2a M0   |\nT3-T4a N2b M0   |\nT4b N1-N2 M0   |\nIVA Any T Any N M1a   |\nIVB Any T Any N M1b

 -- Row 96 -----------------------------------
  Element = Colorectal.synthesisOverview.tumourStagingSystem
  Card. = 1..1
  Type = string
  Short Label = Year and/or edition of staging system
  Definition = Year and/or edition of staging system is to be recorded
  Requirements = Numeric: year\nAND/OR\nText: Edition eg 1st, 2nd etc
  Logical Mapping = synthesis.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  LOINC Code = 67203-0
  Snomed Code = 443941007

 -- Row 97 -----------------------------------
  Element = Colorectal.synthesisOverview.residualTumourStatus
  Card. = 1..1
  Type = string
  Binding = ResidualTumourStatus
  Short Label = Residual tumour status
  Definition = The residual tumour status must be recorded according to the AJCC Cancer Staging Manual (7th Edition)
  Logical Mapping = synthesis.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28317.1000043
  LOINC Code = LN-RCPA-00084
  Snomed Code = 17964000

 -- Row 98 -----------------------------------
  Element = Colorectal.synthesisOverview.diagnosticSummary
  Card. = 0..1
  Summary = Y
  Type = string
  Short Label = Diagnostic summary
  Definition = Diagnostic summary is to be recorded
  Requirements = Include:\na. specimen type\nb. tumour site\nc. tumour type\nd. tumour stage\ne. completeness of excision
  Logical Mapping = dr[conclusion := $value]
  CAP Code = 28842.1000043
  LOINC Code = 22637-3

 -- Row 99 -----------------------------------
  Element = Colorectal.synthesisOverview.newPrimaryOrRecurrence
  Card. = 0..1
  Type = code
  Binding = NewPrimaryOrRecurrence
  Short Label = New primary cancer or recurrence
  Definition = New primary cancer or recurrence is to be recorded
  Requirements = Single selection value list.\nIf regional (local) recurrence or distant metastasis describe.
  Logical Mapping = synthesis.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28472.1000043
  LOINC Code = 21983-2

 -- Row 100 -----------------------------------
  Element = Colorectal.synthesisOverview.newDescription
  Card. = 0..1
  Type = string
  Short Label = Describe
  Definition = Description of regional (local) recurrence or distant metastases
  Requirements = Conditional

 -- Row 101 -----------------------------------
  Element = Colorectal.synthesisOverview.overarchingComment
  Card. = 0..1
  Type = string
  Short Label = Overarching comment
  Definition = Synthesis and overview overarching comment
  Requirements = Conditional
  Logical Mapping = synthesis.related[type:=\'has-member\'].target->Observation[code:=%map-codes; value[x] := $value]
  CAP Code = 28252.1000043
  LOINC Code = 22638-1
